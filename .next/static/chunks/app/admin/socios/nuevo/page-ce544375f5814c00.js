(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2852],{6665:function(e,a,r){Promise.resolve().then(r.bind(r,22656))},22656:function(e,a,r){"use strict";r.r(a),r.d(a,{default:function(){return m}});var t=r(57437),o=r(69690),i=r(17985),n=r(45365),s=r(2265),l=r(99376),c=r(32660),d=r(17689),u=r(27648);function m(){let e=(0,l.useRouter)(),[a,r]=(0,s.useState)(!1),[m,g]=(0,s.useState)(""),[p,x]=(0,s.useState)(!1),[h,f]=(0,s.useState)(""),[b,y]=(0,s.useState)({nombres:"",apellidos:"",ci:"",ruc:"",categoria:"Individual",subcategoria:"Socio",direccion:"",telefono:"",celular:"",email:"",nacimiento:"",nacionalidad:"Paraguaya",datosLaborales:"",alta:(0,n.LJ)(),estado:"AL_DIA",foto:"",observaciones:"",aplicarCuotaIngreso:!1}),v=async e=>{if(!e||0===e.trim().length){f("");return}try{let a=await i.L.authenticatedFetch("/api/members?ci=".concat(encodeURIComponent(e.trim()))),r=await a.json();if(a.ok&&Array.isArray(r)&&r.length>0){let a=r[0];f("Ya existe un ".concat("NO SOCIO"===a.subcategoria?"no-socio":"socio"," registrado con la CI ").concat(e,": ").concat(a.nombres," ").concat(a.apellidos," (").concat(a.codigo,")"))}else f("")}catch(e){console.error("Error validating CI:",e),f("")}},j=async a=>{if(a.preventDefault(),g(""),h){g("Por favor, corrija los errores antes de continuar.");return}r(!0);try{let a=await i.L.authenticatedFetch("/api/members",{method:"POST",body:JSON.stringify(b)}),r=await a.json();if(a.ok){var t;if(b.aplicarCuotaIngreso&&(null===(t=r.member)||void 0===t?void 0:t.id))try{let a=b.alta,t=await i.L.authenticatedFetch("/api/movements",{method:"POST",body:JSON.stringify({memberId:r.member.id,fecha:a,concepto:"Cuota de Ingreso",tipo:"DEBIT",monto:15e6,origen:"SERVICIO",refId:"s2",observaciones:"Cuota de ingreso aplicada autom\xe1ticamente al crear el socio",vencimiento:a})});if(!t.ok){let a=await t.json();console.error("Error al crear d\xe9bito de cuota de ingreso:",a),g("Socio creado exitosamente, pero hubo un error al crear la cuota de ingreso. Puede agregarla manualmente."),setTimeout(()=>e.push("/admin/socios"),2e3);return}}catch(a){console.error("Error al crear d\xe9bito:",a),g("Socio creado exitosamente, pero hubo un error al crear la cuota de ingreso. Puede agregarla manualmente."),setTimeout(()=>e.push("/admin/socios"),2e3);return}e.push("/admin/socios")}else g(r.msg||"Error al crear socio")}catch(e){g("Error de conexi\xf3n")}finally{r(!1)}},N=async e=>{var a;let r=null===(a=e.target.files)||void 0===a?void 0:a[0];if(r){x(!0);try{let e=new FormData;e.append("file",r);let a=await fetch("/api/uploads",{method:"POST",body:e}),t=await a.json();t.ok?y(e=>({...e,foto:t.path})):g("Error al subir la foto")}catch(e){g("Error al subir la foto")}finally{x(!1)}}};return(0,t.jsx)(o.Z,{children:(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsx)(u.default,{href:"/admin/socios",className:"p-2 hover:bg-gray-100 rounded-lg",children:(0,t.jsx)(c.Z,{className:"w-5 h-5"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-2xl font-semibold text-gray-900",children:"Nuevo Socio"}),(0,t.jsx)("p",{className:"text-gray-600",children:"Registra un nuevo socio en el club"})]})]}),m&&(0,t.jsx)("div",{className:"p-4 rounded-lg ".concat(m.includes("Error")?"bg-red-50 text-red-800 border border-red-200":"bg-green-50 text-green-800 border border-green-200"),children:m}),(0,t.jsx)("div",{className:"bg-white rounded-lg shadow",children:(0,t.jsxs)("form",{onSubmit:j,className:"p-6 space-y-8",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Informaci\xf3n Personal"}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nombres *"}),(0,t.jsx)("input",{type:"text",required:!0,className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500",value:b.nombres,onChange:e=>y(a=>({...a,nombres:e.target.value})),placeholder:"Juan Carlos"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Apellidos *"}),(0,t.jsx)("input",{type:"text",required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500",value:b.apellidos,onChange:e=>y(a=>({...a,apellidos:e.target.value})),placeholder:"P\xe9rez L\xf3pez"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"C\xe9dula de Identidad *"}),(0,t.jsx)("input",{type:"text",required:!0,className:"w-full px-3 py-1.5 border rounded-md focus:outline-none focus:ring-2 ".concat(h?"border-red-300 focus:ring-red-500 focus:border-red-500":"border-gray-300 focus:ring-primary-500"),value:b.ci,onChange:e=>{let a=e.target.value;y(e=>({...e,ci:a})),setTimeout(()=>v(a),500)},onBlur:e=>v(e.target.value),placeholder:"1234567"}),h&&(0,t.jsx)("p",{className:"mt-1 text-sm text-red-600",children:h})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"RUC"}),(0,t.jsx)("input",{type:"text",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500",value:b.ruc,onChange:e=>y(a=>({...a,ruc:e.target.value})),placeholder:"1234567-8"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Fecha de Nacimiento"}),(0,t.jsx)("input",{type:"date",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500",value:b.nacimiento,onChange:e=>y(a=>({...a,nacimiento:e.target.value}))})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nacionalidad"}),(0,t.jsx)("input",{type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500",value:b.nacionalidad,onChange:e=>y(a=>({...a,nacionalidad:e.target.value})),placeholder:"Paraguaya"})]})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Categorizaci\xf3n"}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Categor\xeda *"}),(0,t.jsxs)("select",{required:!0,className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500",value:b.categoria,onChange:e=>y(a=>({...a,categoria:e.target.value})),children:[(0,t.jsx)("option",{value:"Individual",children:"Individual"}),(0,t.jsx)("option",{value:"Familiar",children:"Familiar"})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Subcategor\xeda *"}),(0,t.jsxs)("select",{required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500",value:b.subcategoria,onChange:e=>y(a=>({...a,subcategoria:e.target.value})),children:[(0,t.jsx)("option",{value:"Socio",children:"Socio"}),(0,t.jsx)("option",{value:"Socio Patrimonial",children:"Socio Patrimonial"}),(0,t.jsx)("option",{value:"Socio Vitalicio",children:"Socio Vitalicio"})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Estado *"}),(0,t.jsxs)("select",{required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500",value:b.estado,onChange:e=>y(a=>({...a,estado:e.target.value})),children:[(0,t.jsx)("option",{value:"AL_DIA",children:"Al D\xeda"}),(0,t.jsx)("option",{value:"ATRASADO",children:"Atrasado"}),(0,t.jsx)("option",{value:"SUSPENDIDO",children:"Suspendido"})]})]})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Informaci\xf3n de Contacto"}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Direcci\xf3n"}),(0,t.jsx)("input",{type:"text",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500",value:b.direccion,onChange:e=>y(a=>({...a,direccion:e.target.value})),placeholder:"Av. Espa\xf1a 1234, Asunci\xf3n"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tel\xe9fono"}),(0,t.jsx)("input",{type:"tel",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500",value:b.telefono,onChange:e=>y(a=>({...a,telefono:e.target.value})),placeholder:"021-123456"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Celular"}),(0,t.jsx)("input",{type:"tel",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500",value:b.celular,onChange:e=>y(a=>({...a,celular:e.target.value})),placeholder:"0981-123456"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),(0,t.jsx)("input",{type:"email",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500",value:b.email,onChange:e=>y(a=>({...a,email:e.target.value})),placeholder:"juan.perez@email.com"})]})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Informaci\xf3n Adicional"}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-6 gap-4 items-start",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Fecha de Alta *"}),(0,t.jsx)("input",{type:"date",required:!0,className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500",value:b.alta,onChange:e=>y(a=>({...a,alta:e.target.value}))})]}),(0,t.jsxs)("div",{className:"md:col-span-2",children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Datos Laborales"}),(0,t.jsx)("input",{type:"text",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500",value:b.datosLaborales,onChange:e=>y(a=>({...a,datosLaborales:e.target.value})),placeholder:"Contador - Empresa ABC"})]}),(0,t.jsxs)("div",{className:"md:col-span-2",children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Observaciones"}),(0,t.jsx)("input",{type:"text",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500",value:b.observaciones,onChange:e=>y(a=>({...a,observaciones:e.target.value})),placeholder:"Notas adicionales sobre el socio..."})]}),(0,t.jsxs)("div",{className:"md:col-span-1",children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Foto"}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("input",{type:"file",accept:"image/*",onChange:N,className:"hidden",id:"photo-upload",disabled:p}),(0,t.jsxs)("label",{htmlFor:"photo-upload",className:"flex items-center gap-2 px-3 py-1.5 border border-gray-300 rounded-md cursor-pointer hover:bg-gray-50 disabled:opacity-50 text-sm",children:[(0,t.jsx)(d.Z,{className:"w-4 h-4"}),p?"Subiendo...":"Subir Foto"]})]}),b.foto&&(0,t.jsx)("img",{src:b.foto,alt:"Preview",className:"w-10 h-10 rounded-full object-cover mt-2"})]}),(0,t.jsxs)("div",{className:"md:col-span-6",children:[(0,t.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer mt-2",children:[(0,t.jsx)("input",{type:"checkbox",checked:b.aplicarCuotaIngreso,onChange:e=>y(a=>({...a,aplicarCuotaIngreso:e.target.checked})),className:"w-4 h-4 text-primary-600 border-gray-300 rounded focus:ring-primary-500"}),(0,t.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Aplicar Cuota de Ingreso (Gs. 15.000.000)"})]}),(0,t.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Se crear\xe1 autom\xe1ticamente un d\xe9bito por la cuota de ingreso al crear el socio"})]})]})]}),(0,t.jsxs)("div",{className:"flex justify-end gap-3 pt-6 border-t",children:[(0,t.jsx)(u.default,{href:"/admin/socios",className:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50",children:"Cancelar"}),(0,t.jsx)("button",{type:"submit",disabled:a||!!h,className:"px-4 py-2 bg-primary-500 text-white rounded-lg hover:bg-primary-600 disabled:opacity-50 disabled:cursor-not-allowed",children:a?"Creando...":"Crear Socio"})]})]})})]})})}},45365:function(e,a,r){"use strict";r.d(a,{D2:function(){return t},LJ:function(){return i},_4:function(){return n},tF:function(){return o}});let t={name:"America/Asuncion",offsetHours:-3,description:"Paraguay (UTC-3)"};function o(){let e=new Date,a=Object.fromEntries(new Intl.DateTimeFormat("en-CA",{timeZone:t.name,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}).formatToParts(e).map(e=>[e.type,e.value]));return new Date(parseInt(a.year),parseInt(a.month)-1,parseInt(a.day),parseInt(a.hour),parseInt(a.minute),parseInt(a.second))}function i(e){if(e){let a=e.getFullYear(),r=String(e.getMonth()+1).padStart(2,"0"),t=String(e.getDate()).padStart(2,"0");return"".concat(a,"-").concat(r,"-").concat(t)}{let e=new Date;return new Intl.DateTimeFormat("en-CA",{timeZone:t.name,year:"numeric",month:"2-digit",day:"2-digit"}).format(e)}}function n(e){let a,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if("string"==typeof e){if(/^\d{4}-\d{2}-\d{2}$/.test(e)){let[r,t,o]=e.split("-").map(Number);a=new Date(r,t-1,o)}else a=new Date(e)}else a=e;if(r)return a.toLocaleString("es-PY",{timeZone:t.name,day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit",hour12:!1});if(!("string"==typeof e&&/^\d{4}-\d{2}-\d{2}$/.test(e)))return a.toLocaleDateString("es-PY",{timeZone:t.name,day:"2-digit",month:"2-digit",year:"numeric"});{let[a,r,t]=e.split("-");return"".concat(t.padStart(2,"0"),"/").concat(r.padStart(2,"0"),"/").concat(a)}}},32660:function(e,a,r){"use strict";r.d(a,{Z:function(){return t}});let t=(0,r(39763).Z)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},17689:function(e,a,r){"use strict";r.d(a,{Z:function(){return t}});let t=(0,r(39763).Z)("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]])}},function(e){e.O(0,[3643,9690,2971,2117,1744],function(){return e(e.s=6665)}),_N_E=e.O()}]);