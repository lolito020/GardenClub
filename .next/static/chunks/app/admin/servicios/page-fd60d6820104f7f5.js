(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4060],{13709:function(e,t,r){Promise.resolve().then(r.bind(r,80438))},80438:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return h}});var n=r(57437),i=r(69690),a=r(17985),s=r(2265),o=r(99376),c=r(94508),l=r(61649),d=r(48736),u=r(99397),m=r(73247),x=r(17684),p=r(27648);function h(){let e=(0,o.useRouter)(),[t,h]=(0,s.useState)([]),[g,f]=(0,s.useState)(!0),[y,b]=(0,s.useState)(""),[v,j]=(0,s.useState)(""),[w,N]=(0,s.useState)(""),[S,k]=(0,s.useState)(null);async function C(){try{let e=await a.L.authenticatedFetch("/api/services"),t=await e.json();h(Array.isArray(t)?t:[])}catch(e){console.error("Error loading services:",e),h([])}finally{f(!1)}}async function E(e,t){if(confirm('\xbfEst\xe1s seguro de que quieres eliminar el servicio "'.concat(t,'"?')))try{let t=await a.L.authenticatedFetch("/api/services/".concat(e),{method:"DELETE"}),r=await t.json();t.ok?(await C(),k(null),alert("Servicio eliminado correctamente")):alert(r.msg||"Error al eliminar el servicio")}catch(e){console.error("Error deleting service:",e),alert("Error al eliminar el servicio")}}(0,s.useEffect)(()=>{C()},[]),(0,s.useEffect)(()=>{function e(e){e.target.closest("[data-menu-container]")||k(null)}if(S)return document.addEventListener("click",e),()=>document.removeEventListener("click",e)},[S]);let D=t.filter(e=>{let t=e.nombre.toLowerCase().includes(y.toLowerCase())||e.descripcion&&e.descripcion.toLowerCase().includes(y.toLowerCase()),r=!v||e.tipo===v,n=!w||"activo"===w&&e.activo||"inactivo"===w&&!e.activo;return t&&r&&n}),A=e=>(0,n.jsx)("span",{className:"text-sm text-gray-900",children:e});async function L(){try{let e=await Promise.all([r.e(1425),r.e(6919)]).then(r.bind(r,2093)),t=e=>e.toLocaleString("es-PY",{minimumFractionDigits:0,maximumFractionDigits:0}),n=D.map(e=>({Servicio:e.nombre,Precio:t(e.precio),Tipo:e.tipo,Socios:e.socios?"S\xcd":"NO","No Socios":e.noSocios?"S\xcd":"NO",Agendamiento:e.permiteAgendamiento?"S\xcd":"NO",ComisiÃ³n:e.comisionCobrador?"".concat(e.comisionCobrador,"%"):"-"})),i=e.utils.book_new(),a=e.utils.json_to_sheet(n);a["!cols"]=[{wch:30},{wch:12},{wch:10},{wch:10},{wch:12},{wch:15},{wch:12}],e.utils.book_append_sheet(i,a,"Servicios");let s="servicios-".concat(new Date().toISOString().slice(0,10),".xlsx");e.writeFile(i,s)}catch(e){console.error("Error al exportar a Excel:",e),alert("Error al exportar a Excel")}}async function F(){try{let e=await r.e(4346).then(r.t.bind(r,62271,23)),t=await r.e(5950).then(r.t.bind(r,29,23)),n=e.default||e,i=t.default||t;n.vfs=i.vfs;let a=[[{text:"Servicio",style:"tableHeader",bold:!0},{text:"Precio",style:"tableHeader",bold:!0,alignment:"right"},{text:"Tipo",style:"tableHeader",bold:!0},{text:"Socios",style:"tableHeader",bold:!0,alignment:"center"},{text:"No Socios",style:"tableHeader",bold:!0,alignment:"center"},{text:"Agendamiento",style:"tableHeader",bold:!0,alignment:"center"},{text:"Comisi\xf3n",style:"tableHeader",bold:!0,alignment:"center"}]];D.forEach(e=>{a.push([{text:e.nombre,fontSize:9},{text:(0,c.xG)(e.precio),fontSize:9,alignment:"right"},{text:e.tipo,fontSize:9},{text:e.socios?"S\xcd":"NO",fontSize:9,alignment:"center"},{text:e.noSocios?"S\xcd":"NO",fontSize:9,alignment:"center"},{text:e.permiteAgendamiento?"S\xcd":"NO",fontSize:9,alignment:"center"},{text:e.comisionCobrador?"".concat(e.comisionCobrador,"%"):"-",fontSize:9,alignment:"center"}])});let s={pageSize:"A4",pageOrientation:"landscape",pageMargins:[30,60,30,40],header:{margin:[30,20,30,0],columns:[{text:"Reporte de Servicios",style:"header",fontSize:16,bold:!0},{text:new Date().toLocaleDateString("es-PY"),alignment:"right",fontSize:10,margin:[0,5,0,0]}]},content:[{text:"Total de servicios: ".concat(D.length),margin:[0,0,0,10],fontSize:10},{table:{headerRows:1,widths:["*","auto","auto","auto","auto","auto","auto"],body:a},layout:{fillColor:function(e){return 0===e?"#f3f4f6":e%2==0?"#f9fafb":null},hLineWidth:function(){return .5},vLineWidth:function(){return .5},hLineColor:function(){return"#e5e7eb"},vLineColor:function(){return"#e5e7eb"}}}],styles:{header:{fontSize:16,bold:!0,margin:[0,0,0,10]},tableHeader:{fontSize:10,bold:!0,fillColor:"#f3f4f6"}},defaultStyle:{fontSize:9}},o="servicios-".concat(new Date().toISOString().slice(0,10),".pdf");n.createPdf(s).download(o)}catch(e){console.error("Error al exportar a PDF:",e),alert("Error al exportar a PDF")}}return g?(0,n.jsx)(i.Z,{children:(0,n.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,n.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-500"})})}):(0,n.jsx)(i.Z,{children:(0,n.jsxs)("div",{className:"space-y-6",children:[(0,n.jsxs)("div",{className:"mb-6 flex justify-between items-center",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Gesti\xf3n de Servicios"}),(0,n.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:"Administra los servicios disponibles en el club"})]}),(0,n.jsxs)("div",{className:"flex gap-2",children:[(0,n.jsxs)("button",{onClick:L,className:"bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition-colors flex items-center gap-2",title:"Exportar a Excel",children:[(0,n.jsx)(l.Z,{className:"w-5 h-5"}),"Excel"]}),(0,n.jsxs)("button",{onClick:F,className:"bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700 transition-colors flex items-center gap-2",title:"Exportar a PDF",children:[(0,n.jsx)(d.Z,{className:"w-5 h-5"}),"PDF"]}),(0,n.jsxs)("button",{onClick:()=>e.push("/admin/servicios/nuevo"),className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors flex items-center gap-2",children:[(0,n.jsx)(u.Z,{className:"w-5 h-5"}),"Nuevo Servicio"]})]})]}),"        ",(0,n.jsx)("div",{className:"bg-white p-6 rounded-lg shadow",children:(0,n.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Buscar"}),(0,n.jsxs)("div",{className:"relative",children:[(0,n.jsx)(m.Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),(0,n.jsx)("input",{type:"text",placeholder:"Nombre o descripci\xf3n...",className:"w-full pl-10 pr-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500",value:y,onChange:e=>b(e.target.value)})]})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tipo"}),(0,n.jsxs)("select",{className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500",value:v,onChange:e=>j(e.target.value),children:[(0,n.jsx)("option",{value:"",children:"Todos"}),(0,n.jsx)("option",{value:"MENSUAL",children:"Mensual"}),(0,n.jsx)("option",{value:"ANUAL",children:"Anual"}),(0,n.jsx)("option",{value:"UNICO",children:"\xdanico"})]})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Estado"}),(0,n.jsxs)("select",{className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500",value:w,onChange:e=>N(e.target.value),children:[(0,n.jsx)("option",{value:"",children:"Todos"}),(0,n.jsx)("option",{value:"activo",children:"Activos"}),(0,n.jsx)("option",{value:"inactivo",children:"Inactivos"})]})]}),(0,n.jsx)("div",{className:"flex items-end",children:(0,n.jsx)("button",{onClick:()=>{b(""),j(""),N("")},className:"w-full px-3 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Limpiar Filtros"})})]})}),(0,n.jsxs)("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[(0,n.jsx)("div",{className:"overflow-x-auto",children:(0,n.jsxs)("table",{className:"w-full",children:[(0,n.jsx)("thead",{className:"bg-gray-50",children:(0,n.jsxs)("tr",{children:[(0,n.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Servicio"}),(0,n.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Precio"}),(0,n.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Tipo"}),(0,n.jsx)("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Socios"}),(0,n.jsx)("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"No Socios"}),(0,n.jsx)("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Agendamiento"}),(0,n.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Comisi\xf3n"}),(0,n.jsx)("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Acciones"})]})}),(0,n.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:D.map(e=>(0,n.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,n.jsx)("td",{className:"px-6 py-4",children:(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{className:"text-sm font-medium text-gray-900 flex items-center gap-2",children:[e.nombre,e.obligatorio&&(0,n.jsx)("span",{className:"text-gray-900 text-xs",children:"Obligatorio"})]}),e.descripcion&&(0,n.jsx)("div",{className:"text-sm text-gray-500",children:e.descripcion}),e.aplicaA&&e.aplicaA.length>0&&(0,n.jsxs)("div",{className:"text-xs text-gray-400 mt-1",children:["Aplica a: ",e.aplicaA.join(", ")]})]})}),(0,n.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,n.jsx)("div",{className:"text-sm font-medium text-gray-900",children:(0,c.xG)(e.precio)})}),(0,n.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:A(e.tipo)}),(0,n.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-center",children:(0,n.jsx)("span",{className:"text-sm text-gray-900",children:e.socios?"S\xcd":"NO"})}),(0,n.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-center",children:(0,n.jsx)("span",{className:"text-sm text-gray-900",children:e.noSocios?"S\xcd":"NO"})}),(0,n.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-center",children:(0,n.jsx)("span",{className:"text-sm text-gray-900",children:e.permiteAgendamiento?"S\xcd":"NO"})}),(0,n.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.comisionCobrador?"".concat(e.comisionCobrador,"%"):"-"}),(0,n.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:(0,n.jsxs)("div",{className:"relative","data-menu-container":!0,children:[(0,n.jsx)("button",{onClick:t=>{var r;t.preventDefault(),t.stopPropagation(),console.log("Toggling menu for service:",e.id),console.log("toggleMenu called with:",r=e.id,"current openMenuId:",S),k(S===r?null:r)},className:"p-2 hover:bg-gray-50 rounded-full transition-colors border border-transparent hover:border-gray-200",title:"M\xe1s opciones",children:(0,n.jsx)(x.Z,{className:"w-4 h-4 text-gray-500"})}),S===e.id&&(0,n.jsx)("div",{className:"absolute right-0 top-full mt-1 w-48 bg-white rounded-lg shadow-lg border border-gray-200 z-50 overflow-hidden",children:(0,n.jsxs)("div",{className:"py-1",children:[(0,n.jsx)(p.default,{href:"/admin/servicios/".concat(e.id),className:"flex items-center gap-3 px-4 py-2 text-sm text-gray-700 hover:bg-gray-50 transition-colors",onClick:()=>k(null),children:"Ver Detalles"}),(0,n.jsx)(p.default,{href:"/admin/servicios/".concat(e.id,"/editar"),className:"flex items-center gap-3 px-4 py-2 text-sm text-gray-700 hover:bg-gray-50 transition-colors",onClick:()=>k(null),children:"Editar"}),(0,n.jsx)("div",{className:"border-t border-gray-100 my-1"}),(0,n.jsx)("button",{onClick:t=>{t.stopPropagation(),E(e.id,e.nombre)},className:"flex items-center gap-3 w-full px-4 py-2 text-sm text-red-600 hover:bg-red-50 transition-colors text-left",children:"Eliminar"})]})})]})})]},e.id))})]})}),0===D.length&&(0,n.jsxs)("div",{className:"text-center py-12",children:[(0,n.jsx)("div",{className:"text-gray-500",children:y||v||w?"No se encontraron servicios con los filtros aplicados":"No hay servicios registrados"}),!y&&!v&&!w&&(0,n.jsxs)(p.default,{href:"/admin/servicios/nuevo",className:"mt-4 inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-primary-600 bg-primary-100 hover:bg-primary-200",children:[(0,n.jsx)(u.Z,{className:"w-4 h-4 mr-2"}),"Crear primer servicio"]})]})]})]})})}},45365:function(e,t,r){"use strict";r.d(t,{D2:function(){return n},LJ:function(){return a},_4:function(){return s},tF:function(){return i}});let n={name:"America/Asuncion",offsetHours:-3,description:"Paraguay (UTC-3)"};function i(){let e=new Date,t=Object.fromEntries(new Intl.DateTimeFormat("en-CA",{timeZone:n.name,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}).formatToParts(e).map(e=>[e.type,e.value]));return new Date(parseInt(t.year),parseInt(t.month)-1,parseInt(t.day),parseInt(t.hour),parseInt(t.minute),parseInt(t.second))}function a(e){if(e){let t=e.getFullYear(),r=String(e.getMonth()+1).padStart(2,"0"),n=String(e.getDate()).padStart(2,"0");return"".concat(t,"-").concat(r,"-").concat(n)}{let e=new Date;return new Intl.DateTimeFormat("en-CA",{timeZone:n.name,year:"numeric",month:"2-digit",day:"2-digit"}).format(e)}}function s(e){let t,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if("string"==typeof e){if(/^\d{4}-\d{2}-\d{2}$/.test(e)){let[r,n,i]=e.split("-").map(Number);t=new Date(r,n-1,i)}else t=new Date(e)}else t=e;if(r)return t.toLocaleString("es-PY",{timeZone:n.name,day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit",hour12:!1});if(!("string"==typeof e&&/^\d{4}-\d{2}-\d{2}$/.test(e)))return t.toLocaleDateString("es-PY",{timeZone:n.name,day:"2-digit",month:"2-digit",year:"numeric"});{let[t,r,n]=e.split("-");return"".concat(n.padStart(2,"0"),"/").concat(r.padStart(2,"0"),"/").concat(t)}}},94508:function(e,t,r){"use strict";r.d(t,{Fw:function(){return s},Ji:function(){return o},m9:function(){return c},p6:function(){return a},sQ:function(){return d},sU:function(){return l},xG:function(){return i}});var n=r(45365);function i(e){return new Intl.NumberFormat("es-PY",{style:"currency",currency:"PYG",minimumFractionDigits:0}).format(e)}function a(e){return(0,n._4)(e,!1)}function s(e){let t=(0,n.tF)(),r=new Date(new Date(e).getTime()+108e5),i=t.getUTCFullYear()-r.getUTCFullYear(),a=t.getUTCMonth()-r.getUTCMonth();return(a<0||0===a&&t.getUTCDate()<r.getUTCDate())&&i--,i}function o(){return(0,n.LJ)()}function c(e){let t=e.replace(/\D/g,"");return t?t.replace(/\B(?=(\d{3})+(?!\d))/g,"."):""}function l(e){return parseInt(e.replace(/\./g,""))||0}function d(e){return Math.round(e)}},61649:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});let n=(0,r(39763).Z)("FileSpreadsheet",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M14 17h2",key:"10kma7"}]])},48736:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});let n=(0,r(39763).Z)("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]])},17684:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});let n=(0,r(39763).Z)("MoreVertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]])},99397:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});let n=(0,r(39763).Z)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},73247:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});let n=(0,r(39763).Z)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]])}},function(e){e.O(0,[3643,9690,2971,2117,1744],function(){return e(e.s=13709)}),_N_E=e.O()}]);