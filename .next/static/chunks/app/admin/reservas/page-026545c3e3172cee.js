(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[404],{91989:function(e,t,a){Promise.resolve().then(a.bind(a,69234))},69234:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return g}});var s=a(57437),r=a(69690),o=a(17985),n=a(2265),l=a(94508),i=a(45365),c=a(32489),d=a(39763);let m=(0,d.Z)("File",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}]]);var x=a(17689),u=a(22252);let p=(0,d.Z)("Check",[["polyline",{points:"20 6 9 17 4 12",key:"10jjfj"}]]),h=(0,d.Z)("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);function b(e){let{reservationId:t,currentFile:a,currentStatus:r="PENDIENTE",isAdmin:o=!1,onClose:l,onFileUploaded:i,onStatusChange:d}=e,[b,g]=(0,n.useState)(!1),[v,f]=(0,n.useState)(!1),[N,j]=(0,n.useState)(0),[w,y]=(0,n.useState)(null),[C,E]=(0,n.useState)(null),[D,A]=(0,n.useState)(""),k=e=>{if(!["application/pdf","image/jpeg","image/png","image/jpg"].includes(e.type)){alert("❌ Tipo de archivo no v\xe1lido. Solo se permiten PDF, JPG, JPEG y PNG.");return}if(e.size>10485760){alert("❌ El archivo es demasiado grande. M\xe1ximo 10MB permitido.");return}y(e)},T=async()=>{if(w){f(!0),j(0);try{let e=new FormData;e.append("file",w),e.append("reservationId",t);let a=setInterval(()=>{j(e=>e<90?e+10:e)},200),s=await fetch("/api/reservas/apa-upload",{method:"POST",body:e});if(clearInterval(a),j(100),!s.ok)throw Error("Error al subir el archivo");let r=await s.json();await L(t,"ENTREGADO",r.fileUrl),i(r.fileUrl,"ENTREGADO"),setTimeout(()=>{l()},1e3)}catch(e){console.error("Error uploading file:",e),alert("❌ Error al subir el archivo. Intente nuevamente."),j(0)}finally{f(!1)}}},L=async(e,t,a,s)=>{try{if(!(await fetch("/api/reservas/".concat(e,"/apa-status"),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({apaEstado:t,apaComprobante:a,apaObservaciones:s,apaFechaEntrega:"ENTREGADO"===t?new Date().toISOString():void 0})})).ok)throw Error("Error al actualizar estado APA")}catch(e){throw console.error("Error updating APA status:",e),e}},P=async()=>{if(C)try{if(f(!0),w){let e=new FormData;e.append("file",w),e.append("reservationId",t);let a=await fetch("/api/reservas/apa-upload",{method:"POST",body:e});if(!a.ok)throw Error("Error al subir el archivo");let s=await a.json();await L(t,"APROBADO",s.fileUrl,D),i(s.fileUrl,"APROBADO")}else await L(t,"APROBADO",a,D),i(a||"","APROBADO");null==d||d("APROBADO"),l()}catch(e){alert("❌ Error al procesar la aprobaci\xf3n. Intente nuevamente.")}finally{f(!1)}},S="PENDIENTE"===r||"APROBADO"===r||"ENTREGADO"===r,I=o&&("PENDIENTE"===r||"ENTREGADO"===r);return(0,s.jsx)("div",{className:"fixed inset-0 z-50 bg-black/50 flex items-center justify-center p-4",children:(0,s.jsxs)("div",{className:"w-full max-w-lg bg-white rounded-xl shadow-lg",onClick:e=>e.stopPropagation(),children:[(0,s.jsxs)("div",{className:"flex items-center justify-between p-4 border-b bg-slate-50 rounded-t-xl",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-slate-800 flex items-center gap-2",children:"Gesti\xf3n APA"}),(0,s.jsx)("button",{onClick:l,className:"text-gray-400 hover:text-gray-600 p-1 rounded-full hover:bg-gray-200 transition-colors",children:(0,s.jsx)(c.Z,{className:"w-5 h-5"})})]}),(0,s.jsxs)("div",{className:"p-6 space-y-4",children:[(0,s.jsxs)("div",{className:"bg-slate-50 rounded-lg p-3",children:[(0,s.jsx)("h4",{className:"text-sm font-semibold text-slate-700 mb-2",children:"Estado Actual del APA"}),(0,s.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,s.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ".concat("APROBADO"===r?"bg-green-100 text-green-800":"ENTREGADO"===r?"bg-blue-100 text-blue-800":"bg-yellow-100 text-yellow-800"),children:"APROBADO"===r?"✅ Aprobado":"ENTREGADO"===r?"\uD83D\uDCE4 Entregado":"⏳ Pendiente"}),a&&(0,s.jsxs)("a",{href:a,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-800 text-sm flex items-center gap-1",children:[(0,s.jsx)(m,{className:"w-4 h-4"}),"Ver archivo digital"]})]}),"PENDIENTE"===r&&null,"APROBADO"===r&&!a&&(0,s.jsxs)("div",{className:"text-xs text-slate-600 bg-green-50 border border-green-200 rounded p-2",children:[(0,s.jsx)("span",{className:"font-medium",children:"✓ Aprobado:"})," Comprobante f\xedsico verificado en recepci\xf3n."]})]}),S&&(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h4",{className:"text-sm font-semibold text-slate-700",children:"Subir Comprobante APA"}),(0,s.jsx)("p",{className:"text-xs text-slate-500 mt-1",children:(0,s.jsxs)("span",{className:"inline-flex items-center gap-1",children:[(0,s.jsx)("span",{children:"\uD83D\uDCDD"}),"Opcional: No es obligatorio adjuntar el comprobante de pago de APA"]})})]}),(0,s.jsxs)("div",{className:"border-2 border-dashed rounded-lg p-6 text-center transition-colors ".concat(b?"border-blue-400 bg-blue-50":"border-slate-300 hover:border-slate-400"),onDragOver:e=>{e.preventDefault(),g(!0)},onDragLeave:e=>{e.preventDefault(),g(!1)},onDrop:e=>{e.preventDefault(),g(!1);let t=Array.from(e.dataTransfer.files);t.length>0&&k(t[0])},children:[(0,s.jsx)(x.Z,{className:"w-8 h-8 text-slate-400 mx-auto mb-2"}),(0,s.jsxs)("p",{className:"text-sm text-slate-600 mb-2",children:["Arrastra tu archivo aqu\xed o",(0,s.jsxs)("label",{className:"text-blue-600 hover:text-blue-800 cursor-pointer ml-1",children:["selecciona uno",(0,s.jsx)("input",{type:"file",className:"hidden",accept:".pdf,.jpg,.jpeg,.png",onChange:e=>{let t=e.target.files;t&&t.length>0&&k(t[0])}})]})]}),(0,s.jsx)("p",{className:"text-xs text-slate-500",children:"Formatos permitidos: PDF, JPG, PNG (m\xe1x. 10MB)"})]}),w&&(0,s.jsxs)("div",{className:"bg-blue-50 rounded-lg p-3 flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(m,{className:"w-4 h-4 text-blue-600"}),(0,s.jsx)("span",{className:"text-sm font-medium text-blue-900",children:w.name}),(0,s.jsxs)("span",{className:"text-xs text-blue-600",children:["(",(w.size/1024/1024).toFixed(1)," MB)"]})]}),(0,s.jsx)("button",{onClick:()=>y(null),className:"text-blue-600 hover:text-blue-800",children:(0,s.jsx)(c.Z,{className:"w-4 h-4"})})]}),v&&(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,s.jsx)("span",{className:"text-slate-600",children:"Subiendo archivo..."}),(0,s.jsxs)("span",{className:"font-medium",children:[N,"%"]})]}),(0,s.jsx)("div",{className:"w-full bg-slate-200 rounded-full h-2",children:(0,s.jsx)("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:"".concat(N,"%")}})})]})]}),o&&("PENDIENTE"===r||"ENTREGADO"===r)&&(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)("h4",{className:"text-sm font-semibold text-slate-700",children:"Gesti\xf3n Administrativa"}),"ENTREGADO"===r&&a?(0,s.jsx)("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-3",children:(0,s.jsxs)("div",{className:"flex items-start gap-2",children:[(0,s.jsx)(u.Z,{className:"w-5 h-5 text-amber-600 flex-shrink-0 mt-0.5"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm font-medium text-amber-800",children:"Archivo pendiente de revisi\xf3n"}),(0,s.jsx)("p",{className:"text-xs text-amber-700",children:"El usuario ha subido un comprobante que requiere aprobaci\xf3n."})]})]})}):(0,s.jsx)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3",children:(0,s.jsxs)("div",{className:"flex items-start gap-2",children:[(0,s.jsx)(u.Z,{className:"w-5 h-5 text-blue-600 flex-shrink-0 mt-0.5"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm font-medium text-blue-800",children:"Gesti\xf3n administrativa"}),(0,s.jsx)("p",{className:"text-xs text-blue-700",children:"PENDIENTE"===r?"Puede aprobar/rechazar si el comprobante de pago APA fue entregado f\xedsicamente.":"Revisar y decidir sobre el comprobante APA."})]})]})}),(0,s.jsx)("div",{className:"flex justify-center",children:(0,s.jsxs)("button",{onClick:()=>E("approve"),className:"flex items-center justify-center gap-2 px-6 py-3 rounded-lg text-sm font-medium transition-colors ".concat("approve"===C?"bg-green-600 text-white":"bg-green-100 text-green-700 hover:bg-green-200"),children:[(0,s.jsx)(p,{className:"w-4 h-4"}),w?"Subir Archivo y Aprobar":"Aprobar APA"]})}),C&&(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Observaciones (opcionales)"}),(0,s.jsx)("textarea",{value:D,onChange:e=>A(e.target.value),placeholder:"Ej: Comprobante f\xedsico verificado en recepci\xf3n...",className:"w-full border border-slate-300 rounded-lg px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",rows:3})]})]})]}),(0,s.jsxs)("div",{className:"p-4 border-t bg-slate-50 rounded-b-xl flex justify-end gap-2",children:[(0,s.jsx)("button",{onClick:l,className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 text-sm font-medium text-gray-700 transition-colors",children:"Cancelar"}),S&&w&&(0,s.jsx)("button",{onClick:T,disabled:v,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 text-sm font-medium transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:v?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(h,{className:"w-4 h-4 animate-spin"}),"Subiendo..."]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(x.Z,{className:"w-4 h-4"}),"Subir Archivo"]})}),I&&C&&(0,s.jsx)("button",{onClick:P,disabled:v,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 text-sm font-medium transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:v?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(h,{className:"w-4 h-4 animate-spin"}),"Procesando..."]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(p,{className:"w-4 h-4"}),"Confirmar Aprobaci\xf3n"]})})]})]})})}function g(){var e,t,c,d,m,x,u,p;async function h(){try{let e=await a.e(4346).then(a.t.bind(a,62271,23)),t=await a.e(5950).then(a.t.bind(a,29,23));e.default.vfs=t.default.vfs;let s=e=>e.toLocaleString("de-DE",{minimumFractionDigits:0}),r=f.map(e=>{var t;let a="";e.acontecimiento&&(a="15_anos"===e.acontecimiento?"Quincea\xf1era":"boda"===e.acontecimiento?"Boda":"cumpleanos"===e.acontecimiento?"Cumplea\xf1os":"Otro");let r=e.quinceaneraFocusNombre||e.noviosNombres||e.cumpleaneroNombre||e.otrosNombrePersona||"",o=a?r?"".concat(a," - ").concat(r):a:"",n=e.nombreContacto||"",l=e.acontecimiento||"",i="15_anos"===l?"15 a\xf1os":"cumpleanos"===l?"Cumplea\xf1os":"boda"===l?"Boda":"otros"===l?"Otro":l,c=i?"".concat(n," - ").concat(i):n,d=s(e.montoTotal||0),m=s((e.montoTotal||0)-((null===(t=J[e.id])||void 0===t?void 0:t.totalPagado)||0));return[new Date(e.start).toLocaleDateString("es-ES"),"".concat(e4(e.start)," - ").concat(e4(e.end)),(()=>{let t=e_(e);return t.hasSpace?"".concat(t.serviceName," - ").concat(t.spaceName):t.serviceName})(),o,c,e.contacto||"",d,m,e.requiereApa?e.apaEstado||"Pendiente":"No aplica"]}),o={pageOrientation:"landscape",pageSize:"A4",content:[{text:"Reporte de Reservas",style:"header",alignment:"center",margin:[0,0,0,10]},{text:"Fecha de exportaci\xf3n: ".concat(new Date().toLocaleDateString("es-PY")),style:"subheader",margin:[0,0,0,10]},{table:{headerRows:1,widths:["auto","auto","*","*","*","auto","auto","auto","auto"],body:[["Fecha","Horario","Servicio/Espacio","Evento","Contacto","Tel\xe9fono","Monto","Saldo","APA"],...r]},layout:"lightHorizontalLines"}],styles:{header:{fontSize:16,bold:!0},subheader:{fontSize:10,margin:[0,2,0,2]}},defaultStyle:{fontSize:7}},n="reservas_".concat(new Date().toISOString().slice(0,10),".pdf");e.default.createPdf(o).download(n)}catch(e){console.error("Error al generar PDF:",e),alert("Error al generar el PDF. Verifique que pdfmake est\xe9 instalado.")}}let[g,v]=(0,n.useState)([]),[f,N]=(0,n.useState)([]),[j,w]=(0,n.useState)([]),[y,C]=(0,n.useState)([]),[E,D]=(0,n.useState)([]),[A,k]=(0,n.useState)(!0),[T,L]=(0,n.useState)(""),[P,S]=(0,n.useState)(""),[I,O]=(0,n.useState)(""),[M,R]=(0,n.useState)(""),[F,G]=(0,n.useState)("contacto"),[H,B]=(0,n.useState)(""),[z,q]=(0,n.useState)(!1),[V,U]=(0,n.useState)([]),[W,_]=(0,n.useState)(!1),[Y,Z]=(0,n.useState)(""),[J,Q]=(0,n.useState)({}),[$,X]=(0,n.useState)(()=>{let e=new Date;return new Date(e.getFullYear(),e.getMonth(),1)}),[K,ee]=(0,n.useState)(!1),[et,ea]=(0,n.useState)(!1),[es,er]=(0,n.useState)(!1),[eo,en]=(0,n.useState)(!1),[el,ei]=(0,n.useState)(!1),[ec,ed]=(0,n.useState)(null),[em,ex]=(0,n.useState)(!1),[eu,ep]=(0,n.useState)({cancelReason:"",refundType:"TOTAL",refundAmount:"",penaltyAmount:""}),[eh,eb]=(0,n.useState)(0),[eg,ev]=(0,n.useState)([]),[ef,eN]=(0,n.useState)({resourceId:"",fecha:(0,i.LJ)(),inicioHora:"19:00",finHora:"23:00",memberId:"",nombreContacto:"",contacto:"",medioContacto:"telefono",invitados:"",adelanto:"",montoTotal:"",status:"ACTIVO",notas:"",requiereApa:!1,acontecimiento:"",quinceaneraFocusNombre:"",noviosNombres:"",cumpleaneroNombre:"",otrosNombrePersona:"",otrosDescripcion:"",esParaTercero:!1,terceroNombre:"",terceroCedula:"",terceroTelefono:"",terceroRuc:"",cantidadPersonas:"",observacionesGenerales:"",horaExtra:!1,cantidadHorasExtra:1,montoHorasExtra:0,apaEstado:"PENDIENTE"}),[ej,ew]=(0,n.useState)(""),[ey,eC]=(0,n.useState)(!1),eE=(0,n.useRef)(null),[eD,eA]=(0,n.useState)(null),[ek,eT]=(0,n.useState)(null),[eL,eP]=(0,n.useState)(null),[eS,eI]=(0,n.useState)(null),[eO,eM]=(0,n.useState)("year"),eR=(e,t)=>{let a=eK.get(e)||[];if(0===a.length)return;eP(e);let s=t.currentTarget.getBoundingClientRect(),r=Math.min(40*a.length+60,400),o=s.right+8,n=s.top;o+450>window.innerWidth-8&&(o=s.left-450-8),n+r>window.innerHeight-8&&(n=window.innerHeight-r-8),eI({top:n,left:o})},eF=()=>{eP(null),eI(null)};async function eG(){try{let e=await o.L.authenticatedFetch("/api/venues"),t=await e.json();v(Array.isArray(t)?t:[]),Array.isArray(t)&&t.length&&!I&&O(t[0].id)}catch(e){console.error(e)}}async function eH(){try{let e=await o.L.authenticatedFetch("/api/members"),t=await e.json();Array.isArray(t)&&C(t.map(e=>({id:e.id,codigo:e.codigo,nombres:e.nombres,apellidos:e.apellidos,subcategoria:e.subcategoria||""})))}catch(e){console.error(e)}}async function eB(){try{let e=await o.L.authenticatedFetch("/api/services"),t=await e.json();if(Array.isArray(t)){let e=t.filter(e=>!0===e.permiteAgendamiento);D(e.map(e=>({id:e.id,nombre:e.nombre,espacios:e.espacios,espaciosDisponibles:e.espaciosDisponibles})))}}catch(e){console.error(e)}}(0,n.useEffect)(()=>{eG(),eH(),eB()},[]),(0,n.useEffect)(()=>{eY()},[I,$,M,F,T,P,H]),(0,n.useEffect)(()=>{z&&eZ()},[z]),(0,n.useEffect)(()=>{function e(e){let t=e.target;eD&&!(t instanceof Element&&(t.closest("button")||t.closest(".menu-action")))&&(eA(null),eT(null))}function t(){eD&&(eA(null),eT(null)),eL&&eF()}function a(){eD&&(eA(null),eT(null)),eL&&eF()}return document.addEventListener("mousedown",e),window.addEventListener("scroll",t,!0),window.addEventListener("resize",a),()=>{document.removeEventListener("mousedown",e),window.removeEventListener("scroll",t,!0),window.removeEventListener("resize",a)}},[eD,eL]),(0,n.useEffect)(()=>{function e(e){eE.current&&!eE.current.contains(e.target)&&eC(!1)}return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]);let ez=e=>{let t=E.find(t=>t.id===e);return t?t.espaciosDisponibles&&t.espaciosDisponibles.length>0?t.espaciosDisponibles.map(e=>({id:e.id,nombre:e.nombre})):t.espacios&&t.espacios.length>0?t.espacios.map((t,a)=>({id:"".concat(e,"-espacio-").concat(a),nombre:t})):[]:[]};async function eq(){try{let e=await o.L.authenticatedFetch("/api/reservas/update-expired",{method:"POST"});if(e.ok){let t=await e.json();t.updatedCount>0&&console.log("\uD83D\uDD52 ".concat(t.message))}}catch(e){console.warn("Error actualizando estados de reservas:",e)}}let[eV,eU]=(0,n.useState)(!1),eW=e=>{L(e),S("")},e_=e=>{for(let t of E){if(t.espaciosDisponibles&&t.espaciosDisponibles.length>0){let a=t.espaciosDisponibles.find(t=>t.id===e.resourceId);if(a)return{serviceName:t.nombre,spaceName:a.nombre,hasSpace:!0}}if(t.espacios&&t.espacios.length>0){let a=t.espacios.findIndex((a,s)=>{let r="".concat(t.id,"-espacio-").concat(s),o="espacio-".concat(t.id,"-").concat(s);return r===e.resourceId||o===e.resourceId});if(a>=0)return{serviceName:t.nombre,spaceName:t.espacios[a],hasSpace:!0}}}let t=e.resourceId;if(t){if(t.startsWith("servicio-")){let e=t.replace("servicio-",""),a=E.find(t=>t.id===e);if(a)return{serviceName:a.nombre,spaceName:a.nombre,hasSpace:!0}}if(t.includes("tenis")){let e=E.find(e=>e.nombre.toLowerCase().includes("tenis"));if(e){let a=t.replace(/^.*?-/,"").replace(/-/g," ").replace(/\b\w/g,e=>e.toUpperCase());return{serviceName:e.nombre,spaceName:a||"Cancha 1",hasSpace:!0}}return{serviceName:"Tenis",spaceName:"Cancha 1",hasSpace:!0}}if(t.includes("natacion")||t.includes("piscina")){let e=E.find(e=>e.nombre.toLowerCase().includes("nataci\xf3n"));if(e){let a=t.replace(/^.*?-/,"").replace(/-/g," ").replace(/\b\w/g,e=>e.toUpperCase());return{serviceName:e.nombre,spaceName:a||"Piscina 1",hasSpace:!0}}return{serviceName:"Nataci\xf3n",spaceName:"Piscina 1",hasSpace:!0}}if(t.includes("salon")||t.includes("social")){let e=E.find(e=>e.nombre.toLowerCase().includes("sal\xf3n")||e.nombre.toLowerCase().includes("social"));if(e){let a=t.replace(/^.*?-/,"").replace(/-/g," ").replace(/\b\w/g,e=>e.toUpperCase());return{serviceName:e.nombre,spaceName:a||"Sal\xf3n Social",hasSpace:!0}}return{serviceName:"Alquiler Sal\xf3n Social",spaceName:"Sal\xf3n Social",hasSpace:!0}}}let a=g.find(t=>t.id===e.resourceId);return a?{serviceName:a.nombre,spaceName:a.nombre,hasSpace:!1}:{serviceName:"Servicio no especificado",spaceName:"Espacio no especificado",hasSpace:!1}};async function eY(){k(!0);try{await eq();let e=new Date($.getFullYear(),$.getMonth(),1).toISOString().slice(0,10),t=new Date($.getFullYear(),$.getMonth()+1,0).toISOString().slice(0,10),a=new URLSearchParams;if(T){let e=ez(T);if(P)a.set("venueId",P);else if(e.length>0){let t=e.map(e=>e.id).join(",");a.set("venueIds",t)}}else I&&a.set("venueId",I);M&&(a.set("q",M),a.set("searchType",F)),a.set("from",e),a.set("to",t),a.set("status","ACTIVO");let s=await o.L.authenticatedFetch("/api/reservas?".concat(a.toString())),r=await s.json(),n=Array.isArray(r)?r:[],l=n.filter(e=>"ACTIVO"===e.status||"ACTIVE"===e.status||"CONFIRMED"===e.status||"PENDING"===e.status);if(w(l),H){let e=l.filter(e=>new Date(e.start).toISOString().slice(0,10)===H);N(e)}else N(l);let i={};for(let e of n)e.debitMovementId&&e.memberId?i[e.id]=await eJ(e):i[e.id]={totalPagado:e.adelanto||0,pagosCount:0};Q(i)}catch(e){console.error(e),N([])}finally{k(!1)}}async function eZ(){_(!0);try{let e=new URLSearchParams;e.set("includeHistory","true"),Y&&e.set("q",Y);let t=await o.L.authenticatedFetch("/api/reservas?".concat(e.toString())),a=await t.json(),s=(Array.isArray(a)?a:[]).filter(e=>"CULMINADO"===e.status||"CANCELADO"===e.status||"COMPLETED"===e.status||"CANCELED"===e.status);U(s)}catch(e){console.error(e),U([])}finally{_(!1)}}async function eJ(e){let t=[];if(Array.isArray(e.debitMovementIds)&&e.debitMovementIds.length&&t.push(...e.debitMovementIds),e.debitMovementId&&t.push(e.debitMovementId),!t.length||!e.memberId)return{totalPagado:e.adelanto||0,pagosCount:0};try{let a=await o.L.authenticatedFetch("/api/members/".concat(e.memberId,"/movements?pageSize=1000"));if(!a.ok)return console.error("❌ API Error ".concat(a.status,":"),await a.text()),{totalPagado:e.adelanto||0,pagosCount:0};let s=await a.json(),r=(Array.isArray(s)?s:s.items||[]).filter(e=>{var a;return"CREDIT"===e.tipo&&(null===(a=e.allocations)||void 0===a?void 0:a.some(e=>t.includes(e.debitId)))}),n=r.reduce((e,a)=>{if(!a.allocations)return e;let s=a.allocations.filter(e=>t.includes(e.debitId)).reduce((e,t)=>e+Math.abs(t.amount||0),0);return e+s},0),l=e.adelanto||0;return{totalPagado:n+l,pagosCount:r.length+(l>0?1:0)}}catch(t){return console.error("Error obteniendo pagos relacionados:",t),{totalPagado:e.adelanto||0,pagosCount:0}}}let eQ=async(e,t)=>{if(ec)try{N(a=>a.map(a=>a.id===ec.id?{...a,apaComprobante:e,apaEstado:t||a.apaEstado,apaFechaEntrega:"ENTREGADO"===t?new Date().toISOString():a.apaFechaEntrega}:a)),et&&ec&&ed(a=>a?{...a,apaComprobante:e,apaEstado:t||a.apaEstado,apaFechaEntrega:"ENTREGADO"===t?new Date().toISOString():a.apaFechaEntrega}:null),console.log("✅ Archivo APA actualizado para reserva ".concat(ec.id,":"),{fileUrl:e,newStatus:t})}catch(e){console.error("Error actualizando estado local despu\xe9s del archivo APA:",e)}},e$=(0,n.useMemo)(()=>{let e=$.getFullYear(),t=[];for(let a=0;a<12;a++){let s=new Date(e,a,1),r=new Date(s);r.setDate(s.getDate()-(s.getDay()+6)%7);let o=[];for(let e=0;e<6;e++){let t=[];for(let a=0;a<7;a++){let s=new Date(r);s.setDate(r.getDate()+(7*e+a)),t.push(new Date(s))}o.push(t)}t.push({month:a,matrix:o})}return t},[$]);function eX(e){return e.toISOString().slice(0,10)}let eK=(0,n.useMemo)(()=>{let e=new Map;for(let t of j){let a=new Date(t.start),s=new Date(t.end);for(let r=new Date(a);r<=s;r.setDate(r.getDate()+1)){let a=eX(r),s=e.get(a)||[];s.find(e=>e.id===t.id)||s.push(t),e.set(a,s)}}return e},[j]),e0=(0,n.useMemo)(()=>{let e=new Map;for(let[t,a]of eK){let s=a.filter(e=>"CANCELED"!==e.status);if(0===s.length){e.set(t,"available");continue}let r=s.some(e=>"boda"===e.acontecimiento||"15_anos"===e.acontecimiento||e.horaExtra&&(e.cantidadHorasExtra||0)>2||e.requiereApa&&"PENDIENTE"===e.apaEstado);s.some((e,t)=>s.slice(t+1).some(t=>e.resourceId===t.resourceId&&new Date(e.start)<new Date(t.end)&&new Date(e.end)>new Date(t.start)))?e.set(t,"conflict"):r?e.set(t,"special"):s.length>=3?e.set(t,"busy"):e.set(t,"available")}return e},[eK]);function e2(e){let t=e;"ACTIVE"===e||"RESERVADO"===e||"PENDING"===e?t="ACTIVO":"COMPLETED"===e?t="CULMINADO":"CANCELED"===e&&(t="CANCELADO");let a=t;return{className:({ACTIVO:"bg-emerald-100 border-emerald-300 text-emerald-800",CULMINADO:"bg-blue-100 border-blue-300 text-blue-800",CANCELADO:"bg-red-100 border-red-300 text-red-800",HOLD:"bg-amber-100 border-amber-300 text-amber-800",PENDING:"bg-slate-100 border-slate-300 text-slate-800",CONFIRMED:"bg-emerald-100 border-emerald-300 text-emerald-800",COMPLETED:"bg-blue-100 border-blue-300 text-blue-800",CANCELED:"bg-red-100 border-red-300 text-red-800"})[a]||"bg-gray-100 border-gray-300 text-gray-800",label:({ACTIVO:"Activo",CULMINADO:"Culminado",CANCELADO:"Cancelado",HOLD:"En Espera",PENDING:"Pendiente",CONFIRMED:"Confirmada",COMPLETED:"Completada",CANCELED:"Cancelada"})[a]||a}}async function e1(e){try{(await o.L.authenticatedFetch("/api/reservas/".concat(e,"?permanent=true"),{method:"DELETE"})).ok?eZ():alert("Error al eliminar la reserva")}catch(e){console.error("Error:",e),alert("Error al eliminar la reserva")}}function e4(e){return new Date(e).toTimeString().slice(0,5)}function e3(e){let t=new Date(e.end);return e.horaExtra&&e.cantidadHorasExtra&&t.setHours(t.getHours()+e.cantidadHorasExtra),t.toISOString()}function e5(e){ed(e),ea(!0)}function e6(e){var t,a,s,r;ed(e);let o=new Date(e.start),n=new Date(e.end);if(eN({resourceId:e.resourceId,fecha:o.toISOString().slice(0,10),inicioHora:o.toTimeString().slice(0,5),finHora:n.toTimeString().slice(0,5),memberId:e.memberId||"",nombreContacto:e.nombreContacto||"",contacto:e.contacto||"",medioContacto:e.medioContacto||"telefono",invitados:(null===(t=e.invitados)||void 0===t?void 0:t.toString())||"",adelanto:(null===(a=e.adelanto)||void 0===a?void 0:a.toString())||"",montoTotal:(null===(s=e.montoTotal)||void 0===s?void 0:s.toString())||"",status:e.status,notas:e.notas||"",requiereApa:e.requiereApa||!1,acontecimiento:e.acontecimiento||"",quinceaneraFocusNombre:e.quinceaneraFocusNombre||"",noviosNombres:e.noviosNombres||"",cumpleaneroNombre:e.cumpleaneroNombre||"",otrosNombrePersona:e.otrosNombrePersona||"",otrosDescripcion:e.otrosDescripcion||"",esParaTercero:e.esParaTercero||!1,terceroNombre:e.terceroNombre||"",terceroCedula:e.terceroCedula||"",terceroTelefono:e.terceroTelefono||"",terceroRuc:e.terceroRuc||"",cantidadPersonas:(null===(r=e.cantidadPersonas)||void 0===r?void 0:r.toString())||"",observacionesGenerales:e.observacionesGenerales||"",horaExtra:e.horaExtra||!1,cantidadHorasExtra:e.cantidadHorasExtra||1,montoHorasExtra:e.montoHorasExtra||0,apaEstado:e.apaEstado||"PENDIENTE"}),e.memberId){let t=y.find(t=>t.id===e.memberId);t&&ew("".concat(t.nombres," ").concat(t.apellidos," (").concat(t.codigo,")"))}else ew("");er(!0)}function e8(){ea(!1),er(!1),ei(!1),ed(null),ew(""),eC(!1),ep({cancelReason:"",refundType:"TOTAL",refundAmount:"",penaltyAmount:""}),eb(0)}async function e7(e){ed(e),ei(!0);let t=await eJ(e);eb(t.totalPagado),0===t.totalPagado&&ep(e=>({...e,refundType:"NINGUNO"}))}async function e9(){if(!ec)return;if(!eu.cancelReason.trim()){alert("Por favor ingrese un motivo para la cancelaci\xf3n");return}if("PARCIAL"===eu.refundType){let e=parseFloat(eu.refundAmount||"0"),t=parseFloat(eu.penaltyAmount||"0");if(e<=0&&t<=0){alert("Para reembolso parcial debe especificar ambos montos");return}if(Math.abs(e+t-eh)>1){alert("La suma de reembolso (".concat(e,") + penalizaci\xf3n (").concat(t,") debe ser igual al total pagado (").concat(eh,")"));return}}let e="\xbfConfirmar cancelaci\xf3n de reserva?\n\nTipo de reembolso: ".concat(eu.refundType);if(e+="\nTotal reserva: Gs. ".concat(ec.montoTotal.toLocaleString("es-PY"))+"\nTotal pagado: Gs. ".concat(eh.toLocaleString("es-PY")),"NINGUNO"===eu.refundType?e+="\n\nEl club retendr\xe1: Gs. ".concat(eh.toLocaleString("es-PY")):"TOTAL"===eu.refundType?e+="\n\nSe devolver\xe1 al socio: Gs. ".concat(eh.toLocaleString("es-PY")):"PARCIAL"===eu.refundType&&(e+="\n\nReembolso al socio: Gs. ".concat(parseFloat(eu.refundAmount||"0").toLocaleString("es-PY"))+"\nPenalizaci\xf3n (club retiene): Gs. ".concat(parseFloat(eu.penaltyAmount||"0").toLocaleString("es-PY"))),confirm(e)){ex(!0);try{let e={cancelReason:eu.cancelReason,refundType:eu.refundType};"PARCIAL"===eu.refundType&&(e.refundAmount=parseFloat(eu.refundAmount||"0"),e.penaltyAmount=parseFloat(eu.penaltyAmount||"0"));let t=await o.L.authenticatedFetch("/api/reservas/".concat(ec.id,"/cancel"),{method:"PATCH",body:JSON.stringify(e)});if(!t.ok){let e=await t.json();throw Error(e.msg||"Error al cancelar reserva")}let a=(await t.json()).cancellationDetails;alert("✅ Reserva cancelada exitosamente\n\n"+"Tipo de reembolso: ".concat(a.refundType,"\n")+"Monto total reserva: Gs. ".concat(a.totalAmount.toLocaleString("es-PY"),"\n")+"Total pagado: Gs. ".concat(a.totalPagado.toLocaleString("es-PY"),"\n")+"Reembolso al socio: Gs. ".concat(a.refundAmount.toLocaleString("es-PY"),"\n")+"Penalizaci\xf3n (club retiene): Gs. ".concat(a.penaltyAmount.toLocaleString("es-PY"),"\n")+"Pagos eliminados: ".concat(a.deletedPayments,"\n")+"Movimientos creados: ".concat(a.movementsCreated)),e8(),await eY()}catch(e){console.error("Error canceling reservation:",e),alert("❌ Error: ".concat(e instanceof Error?e.message:"Error desconocido"))}finally{ex(!1)}}}async function te(){if(!ec)return;let e=function(){var e,t;let a=[];if(ef.resourceId||a.push("Debe seleccionar un sal\xf3n"),ef.fecha||a.push("Debe seleccionar una fecha"),ef.inicioHora||a.push("Debe especificar hora de inicio"),ef.finHora||a.push("Debe especificar hora de fin"),ef.fecha&&ef.inicioHora&&ef.finHora){let e=new Date("".concat(ef.fecha,"T").concat(ef.inicioHora,":00")),t=new Date("".concat(ef.fecha,"T").concat(ef.finHora,":00"));if(t<=e&&t.setDate(t.getDate()+1),isNaN(e.getTime())||isNaN(t.getTime()))a.push("Las fechas y horas no son v\xe1lidas");else{e<new Date(new Date().getTime()-36e5)&&a.push("No se pueden crear reservas en el pasado");let s=(t.getTime()-e.getTime())/36e5;s<.5&&a.push("La duraci\xf3n m\xednima es de 30 minutos"),s>24&&a.push("La duraci\xf3n m\xe1xima es de 24 horas")}}return ef.invitados&&(isNaN(Number(ef.invitados))||0>Number(ef.invitados))&&a.push("El n\xfamero de invitados debe ser v\xe1lido"),ef.montoTotal&&(isNaN(Number(ef.montoTotal))||0>Number(ef.montoTotal))&&a.push("El monto total debe ser v\xe1lido"),ef.adelanto&&(isNaN(Number(ef.adelanto))||0>Number(ef.adelanto))&&a.push("El adelanto debe ser v\xe1lido"),ef.adelanto&&ef.montoTotal&&Number(ef.adelanto)>Number(ef.montoTotal)&&a.push("El adelanto no puede ser mayor al monto total"),(null===(e=ef.nombreContacto)||void 0===e?void 0:e.trim())||(null===(t=ef.contacto)||void 0===t?void 0:t.trim())||a.push("Debe especificar al menos un nombre de contacto o informaci\xf3n de contacto"),a}();if(e.length>0)return alert("Errores en el formulario:\n\n• "+e.join("\n• "));let t=new Date("".concat(ef.fecha,"T").concat(ef.inicioHora,":00")),a=new Date("".concat(ef.fecha,"T").concat(ef.finHora,":00")),s=new Date(ec.start),r=new Date(ec.end);if(t.getTime()!==s.getTime()||a.getTime()!==r.getTime()||ef.resourceId!==ec.resourceId){let e=f.filter(e=>e.id!==ec.id&&e.resourceId===ef.resourceId&&"CANCELED"!==e.status&&new Date(e.start)<a&&new Date(e.end)>t);if(e.length>0&&!function(e){let t=e.map(e=>"• ".concat(e.nombreContacto||"Sin nombre"," - ").concat(e4(e.start),"-").concat(e4(e.end))).join("\n");return confirm("⚠️ CONFLICTO DE HORARIOS\n\nYa hay reservas en este horario:\n".concat(t,"\n\n\xbfDeseas continuar de todas formas?"))}(e))return}ex(!0);try{let e;let s=E.find(e=>e.id===T);if(s){let t;s.espaciosDisponibles&&s.espaciosDisponibles.length>0&&(t=s.espaciosDisponibles.find(e=>e.id===ef.resourceId))&&"number"==typeof t.precioHoraExtra&&(e=t.precioHoraExtra),"number"!=typeof e&&"number"==typeof s.precioHoraExtra&&(e=s.precioHoraExtra)}(null==ec?void 0:ec.horaExtra)&&ec.cantidadHorasExtra;let r={resourceId:ef.resourceId,start:t.toISOString(),end:a.toISOString(),memberId:ef.memberId||void 0,nombreContacto:ef.nombreContacto||void 0,contacto:ef.contacto||void 0,medioContacto:ef.medioContacto,invitados:ef.invitados?Number(ef.invitados):void 0,adelanto:ef.adelanto?Number(ef.adelanto):void 0,montoTotal:ef.montoTotal?Number(ef.montoTotal):void 0,status:ef.status,notas:ef.notas||void 0,horaExtra:ef.horaExtra||!1,cantidadHorasExtra:ef.horaExtra?ef.cantidadHorasExtra:void 0,montoHorasExtra:ef.horaExtra?ef.montoHorasExtra:void 0,acontecimiento:ef.acontecimiento||void 0,quinceaneraFocusNombre:ef.quinceaneraFocusNombre||void 0,noviosNombres:ef.noviosNombres||void 0,cumpleaneroNombre:ef.cumpleaneroNombre||void 0,otrosNombrePersona:ef.otrosNombrePersona||void 0,otrosDescripcion:ef.otrosDescripcion||void 0,esParaTercero:ef.esParaTercero||!1,terceroNombre:ef.terceroNombre||void 0,terceroCedula:ef.terceroCedula||void 0,terceroTelefono:ef.terceroTelefono||void 0,terceroRuc:ef.terceroRuc||void 0,cantidadPersonas:ef.cantidadPersonas?Number(ef.cantidadPersonas):void 0,observacionesGenerales:ef.observacionesGenerales||void 0};ef.requiereApa?(r.requiereApa=!0,r.apaEstado=ef.apaEstado||"PENDIENTE"):(r.requiereApa=!1,r.apaEstado="NO_APLICA");let n=await o.L.authenticatedFetch("/api/reservas/".concat(ec.id),{method:"PATCH",body:JSON.stringify(r)}),l=await n.json().catch(()=>({}));if(!n.ok)return console.error(l),alert((null==l?void 0:l.msg)||"No se pudo actualizar la reserva");alert("Reserva actualizada exitosamente"),e8(),await eY()}catch(e){console.error(e),alert((null==e?void 0:e.message)||"Error actualizando reserva")}finally{ex(!1)}}return(0,n.useMemo)(()=>{if(!ej.trim())return y.slice(0,10);let e=ej.toLowerCase();return y.filter(t=>t.nombres.toLowerCase().includes(e)||t.apellidos.toLowerCase().includes(e)||t.codigo.toLowerCase().includes(e)).slice(0,10)},[ej,y]),(0,s.jsx)(r.Z,{children:(0,s.jsx)(s.Fragment,{children:(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"flex flex-col space-y-4 sm:flex-row sm:items-center sm:justify-between sm:space-y-0",children:[(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("h1",{className:"text-2xl sm:text-3xl font-bold text-slate-900 tracking-tight",children:"Reservas"}),!A&&(0,s.jsxs)("div",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm font-semibold bg-blue-100 text-blue-800 border border-blue-200",children:[f.length," ",1===f.length?"reserva":"reservas"]})]}),(0,s.jsx)("p",{className:"text-slate-600 mt-1 text-sm sm:text-base",children:"Gestion\xe1 salones, reservas y pagos parciales con facilidad"})]}),(0,s.jsx)("div",{className:"flex gap-3",children:(0,s.jsxs)("button",{onClick:()=>q(!0),className:"inline-flex items-center px-3 sm:px-4 py-2.5 rounded-lg text-xs sm:text-sm font-semibold transition-all duration-200 bg-gradient-to-r from-blue-600 to-blue-700 text-white hover:from-blue-700 hover:to-blue-800 shadow-lg shadow-blue-500/25 hover:shadow-blue-500/40 hover:scale-105",children:[(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,s.jsx)("span",{className:"hidden sm:inline",children:"Historial de Reservas"}),(0,s.jsx)("span",{className:"sm:hidden",children:"Historial"})]})})]}),(0,s.jsx)("div",{className:"bg-gradient-to-r from-white to-slate-50 p-4 sm:p-6 rounded-xl shadow-sm border border-slate-200 backdrop-blur-sm",children:(0,s.jsxs)("div",{className:"flex items-center justify-center gap-2 sm:gap-3",children:[(0,s.jsxs)("div",{className:"flex items-center bg-slate-100 rounded-lg p-1",children:[(0,s.jsxs)("button",{onClick:()=>eM("year"),className:"flex items-center gap-1 px-2 sm:px-3 py-1.5 text-xs sm:text-sm font-medium rounded-md transition-all duration-200 ".concat("year"===eO?"bg-white text-slate-900 shadow-sm":"text-slate-600 hover:text-slate-900"),title:"Vista anual - Ver todos los 12 meses",children:[(0,s.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[(0,s.jsx)("rect",{x:"3",y:"4",width:"18",height:"18",rx:"2",ry:"2"}),(0,s.jsx)("line",{x1:"16",y1:"2",x2:"16",y2:"6"}),(0,s.jsx)("line",{x1:"8",y1:"2",x2:"8",y2:"6"}),(0,s.jsx)("line",{x1:"3",y1:"10",x2:"21",y2:"10"})]}),(0,s.jsx)("span",{className:"hidden sm:inline",children:"A\xf1o Completo"})]}),(0,s.jsxs)("button",{onClick:()=>eM("month"),className:"flex items-center gap-1 px-2 sm:px-3 py-1.5 text-xs sm:text-sm font-medium rounded-md transition-all duration-200 ".concat("month"===eO?"bg-white text-slate-900 shadow-sm":"text-slate-600 hover:text-slate-900"),title:"Vista mensual - Un mes espec\xedfico",children:[(0,s.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[(0,s.jsx)("rect",{x:"3",y:"4",width:"18",height:"18",rx:"2",ry:"2"}),(0,s.jsx)("line",{x1:"16",y1:"2",x2:"16",y2:"6"}),(0,s.jsx)("line",{x1:"8",y1:"2",x2:"8",y2:"6"}),(0,s.jsx)("line",{x1:"3",y1:"10",x2:"21",y2:"10"}),(0,s.jsx)("path",{d:"M8 14h.01M12 14h.01M16 14h.01M8 18h.01M12 18h.01M16 18h.01"})]}),(0,s.jsx)("span",{className:"hidden sm:inline",children:"Mes Individual"})]})]}),(0,s.jsx)("button",{onClick:function(){let e=new Date($);e.setMonth(e.getMonth()-1),X(e)},className:"border border-slate-300 rounded-lg p-2.5 hover:bg-slate-50 hover:border-slate-400 transition-all duration-200 text-slate-600 hover:text-slate-900",title:"Mes anterior",children:(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),(0,s.jsx)("select",{value:$.getMonth(),onChange:e=>{let t=parseInt(e.target.value,10);X(new Date($.getFullYear(),t,1))},className:"border border-slate-300 rounded-lg px-3 py-2 text-sm w-28 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 mr-2","aria-label":"Seleccionar mes",title:"Seleccionar mes",children:Array.from({length:12}).map((e,t)=>(0,s.jsx)("option",{value:t,children:new Date(2e3,t,1).toLocaleString("es-ES",{month:"long"}).replace(/^\w/,e=>e.toUpperCase())},t))}),(0,s.jsx)("select",{value:$.getFullYear(),onChange:e=>{X(new Date(parseInt(e.target.value,10),$.getMonth(),1))},className:"border border-slate-300 rounded-lg px-3 py-2 text-sm w-24 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200","aria-label":"Seleccionar a\xf1o",title:"Seleccionar a\xf1o",children:(()=>{let e=Math.max(2025,new Date().getFullYear());return Array.from({length:11}).map((t,a)=>{let r=e+a;return(0,s.jsx)("option",{value:r,children:r},r)})})()}),(0,s.jsx)("button",{onClick:function(){let e=new Date($);e.setMonth(e.getMonth()+1),X(e)},className:"border border-slate-300 rounded-lg p-2.5 hover:bg-slate-50 hover:border-slate-400 transition-all duration-200 text-slate-600 hover:text-slate-900",title:"Mes siguiente",children:(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})]})}),(0,s.jsx)("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-4 sm:p-6",children:"year"===eO?(0,s.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:e$.map(e=>{let{month:t,matrix:a}=e;return(0,s.jsxs)("div",{className:"border rounded-lg p-3 bg-white shadow-sm",children:[(0,s.jsx)("div",{className:"text-center mb-2",children:(0,s.jsx)("span",{className:"font-bold text-slate-900 text-sm",children:new Date($.getFullYear(),t).toLocaleString("es-ES",{month:"long"}).replace(/^\w/,e=>e.toUpperCase())})}),(0,s.jsx)("div",{className:"grid grid-cols-7 gap-1 text-xs font-medium text-slate-500 mb-2",children:["L","M","X","J","V","S","D"].map(e=>(0,s.jsx)("div",{className:"text-center py-1",children:e},e))}),(0,s.jsx)("div",{className:"grid grid-cols-7 gap-1",children:a.map((e,a)=>(0,s.jsx)("div",{className:"contents",children:e.map((e,a)=>{let r=e.getMonth()!==t,o=eX(e),n=eK.get(o)||[],l=e0.get(o),i="",c="border-slate-200";if(!r&&n.length>0)switch(l){case"conflict":i="bg-gradient-to-br from-red-50 to-red-100",c="border-red-300";break;case"special":i="bg-gradient-to-br from-purple-50 to-purple-100",c="border-purple-300";break;case"busy":i="bg-gradient-to-br from-amber-50 to-amber-100",c="border-amber-300";break;default:i="bg-gradient-to-br from-emerald-50 to-emerald-100",c="border-emerald-300"}return(0,s.jsx)("div",{className:"h-8 border rounded flex items-center justify-center text-xs font-medium cursor-pointer hover:shadow-sm transition-all duration-200 relative ".concat(r?"text-slate-300 bg-slate-50":n.length>0?"".concat(i," ").concat(c," text-slate-700 hover:shadow-md"):"text-slate-600 bg-white hover:bg-slate-50 border-slate-200"," ").concat(H===o?"ring-2 ring-blue-600 bg-blue-100 border-blue-400 shadow-md":""),title:r?"":H===o?"".concat(n.length," reserva(s) - Clic para quitar filtro"):n.length>0?"".concat(n.length," reserva(s) - Clic para filtrar"):"Clic para ver reservas de este d\xeda",onClick:r?void 0:()=>{H===o?B(""):B(o)},onMouseEnter:!r&&n.length>0?e=>eR(o,e):void 0,onMouseLeave:eF,children:(0,s.jsxs)("span",{className:"relative",children:[e.getDate(),!r&&n.length>0&&(0,s.jsx)("span",{className:"absolute -top-1 -right-1 min-w-[12px] h-3 bg-blue-500 rounded-full text-[8px] text-white flex items-center justify-center px-0.5 font-bold",children:n.length>9?"9+":n.length})]})},a)})},a))})]},t)})}):(0,s.jsx)("div",{className:"max-w-4xl mx-auto",children:(0,s.jsxs)("div",{className:"border rounded-lg p-4 bg-white shadow-sm",children:[(0,s.jsx)("div",{className:"text-center mb-4",children:(0,s.jsx)("span",{className:"font-bold text-slate-900 text-xl",children:$.toLocaleString("es-ES",{month:"long",year:"numeric"}).replace(/^\w/,e=>e.toUpperCase())})}),(0,s.jsx)("div",{className:"grid grid-cols-7 gap-2 text-sm font-medium text-slate-500 mb-3",children:["Lunes","Martes","Mi\xe9rcoles","Jueves","Viernes","S\xe1bado","Domingo"].map(e=>(0,s.jsx)("div",{className:"text-center py-2",children:e},e))}),(0,s.jsx)("div",{className:"grid grid-cols-7 gap-2",children:null===(e=e$.find(e=>e.month===$.getMonth()))||void 0===e?void 0:e.matrix.map((e,t)=>(0,s.jsx)("div",{className:"contents",children:e.map((e,t)=>{let a=e.getMonth()===$.getMonth(),r=eX(e),o=eK.get(r)||[],n=e0.get(r),l="",i="border-slate-200";if(a&&o.length>0)switch(n){case"conflict":l="bg-gradient-to-br from-red-50 to-red-100",i="border-red-300";break;case"special":l="bg-gradient-to-br from-purple-50 to-purple-100",i="border-purple-300";break;case"busy":l="bg-gradient-to-br from-amber-50 to-amber-100",i="border-amber-300";break;default:l="bg-gradient-to-br from-emerald-50 to-emerald-100",i="border-emerald-300"}return(0,s.jsx)("div",{className:"h-16 border rounded-lg flex flex-col items-center justify-center text-sm font-medium cursor-pointer hover:shadow-sm transition-all duration-200 relative ".concat(a?o.length>0?"".concat(l," ").concat(i," text-slate-700 hover:shadow-md"):"text-slate-600 bg-white hover:bg-slate-50 border-slate-200":"text-slate-300 bg-slate-50"," ").concat(H===r?"ring-2 ring-blue-600 bg-blue-100 border-blue-400 shadow-md":""),title:a?H===r?"".concat(o.length," reserva(s) - Clic para quitar filtro"):o.length>0?"".concat(o.length," reserva(s) - Clic para filtrar"):"Clic para ver reservas de este d\xeda":"",onClick:a?()=>{H===r?B(""):B(r)}:void 0,onMouseEnter:a&&o.length>0?e=>eR(r,e):void 0,onMouseLeave:eF,children:(0,s.jsxs)("span",{className:"relative text-lg",children:[e.getDate(),a&&o.length>0&&(0,s.jsx)("span",{className:"absolute -top-2 -right-2 min-w-[16px] h-4 bg-blue-500 rounded-full text-[10px] text-white flex items-center justify-center px-1 font-bold",children:o.length>9?"9+":o.length})]})},t)})},t))})]})})}),(0,s.jsxs)("div",{className:"bg-gradient-to-r from-white to-slate-50 p-4 sm:p-6 rounded-xl shadow-sm border border-slate-200 space-y-4 sm:space-y-0 sm:flex sm:flex-wrap sm:gap-4 sm:items-end backdrop-blur-sm",children:[(0,s.jsxs)("div",{className:"min-w-[180px]",children:[(0,s.jsx)("label",{className:"text-sm font-semibold text-slate-700 mb-2 block",children:"Servicios"}),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("div",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-slate-400",children:(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})})}),(0,s.jsxs)("select",{value:T,onChange:e=>eW(e.target.value),className:"w-full border border-slate-300 rounded-lg pl-10 pr-10 py-2.5 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 appearance-none bg-white hover:border-slate-400 hover:shadow-sm",children:[(0,s.jsx)("option",{value:"",children:"Todos los servicios"}),E.map(e=>(0,s.jsx)("option",{value:e.id,children:e.nombre},e.id))]}),(0,s.jsx)("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-slate-400 pointer-events-none",children:(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]})]}),T&&ez(T).length>0&&(0,s.jsxs)("div",{className:"min-w-[180px]",children:[(0,s.jsx)("label",{className:"text-sm font-semibold text-slate-700 mb-2 block",children:"Espacios"}),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("div",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-slate-400",children:(0,s.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})]})}),(0,s.jsxs)("select",{value:P,onChange:e=>S(e.target.value),className:"w-full border border-slate-300 rounded-lg pl-10 pr-10 py-2.5 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 appearance-none bg-white hover:border-slate-400 hover:shadow-sm",children:[(0,s.jsx)("option",{value:"",children:"Todos los espacios"}),ez(T).map(e=>(0,s.jsx)("option",{value:e.id,children:e.nombre},e.id))]}),(0,s.jsx)("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-slate-400 pointer-events-none",children:(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]})]}),(0,s.jsxs)("div",{className:"min-w-[160px]",children:[(0,s.jsx)("label",{className:"text-sm font-semibold text-slate-700 mb-2 block",children:"Fecha espec\xedfica"}),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("div",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-slate-400",children:(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),(0,s.jsx)("input",{type:"date",value:H,onChange:e=>B(e.target.value),className:"w-full border border-slate-300 rounded-lg pl-10 pr-4 py-2.5 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 bg-white hover:border-slate-400 hover:shadow-sm"}),H&&(0,s.jsx)("button",{onClick:()=>B(""),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-slate-400 hover:text-slate-600 transition-colors",title:"Limpiar fecha",children:(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})]}),(0,s.jsxs)("div",{className:"flex-1 min-w-[200px]",children:[(0,s.jsx)("label",{className:"text-sm font-semibold text-slate-700 mb-2 block",children:"Buscar"}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)("div",{className:"w-32",children:(0,s.jsxs)("select",{value:F,onChange:e=>G(e.target.value),className:"w-full border border-slate-300 rounded-lg px-3 py-2.5 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 bg-white hover:border-slate-400 hover:shadow-sm",children:[(0,s.jsx)("option",{value:"contacto",children:"Contacto"}),(0,s.jsx)("option",{value:"evento",children:"Evento"})]})}),(0,s.jsxs)("div",{className:"relative flex-1",children:[(0,s.jsx)("div",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-slate-400",children:(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),(0,s.jsx)("input",{value:M,onChange:e=>R(e.target.value),placeholder:"contacto"===F?"Buscar por cliente, tel\xe9fono, email...":"Buscar por tipo de evento, descripci\xf3n...",className:"w-full border border-slate-300 rounded-lg pl-10 pr-4 py-2.5 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 bg-white hover:border-slate-400 hover:shadow-sm"}),M&&(0,s.jsx)("button",{onClick:()=>R(""),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-slate-400 hover:text-slate-600 transition-colors",title:"Limpiar b\xfasqueda",children:(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})]})]})]}),(0,s.jsxs)("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden",children:[(0,s.jsxs)("div",{className:"flex flex-wrap gap-2 items-center justify-end px-4 pt-4 pb-2",children:[(0,s.jsx)("button",{onClick:function(){Promise.all([a.e(1425),a.e(6919)]).then(a.bind(a,2093)).then(e=>{let t=f.map(e=>{var t;let a="";e.acontecimiento&&(a="15_anos"===e.acontecimiento?"Quincea\xf1era":"boda"===e.acontecimiento?"Boda":"cumpleanos"===e.acontecimiento?"Cumplea\xf1os":"Otro");let s=e.quinceaneraFocusNombre||e.noviosNombres||e.cumpleaneroNombre||e.otrosNombrePersona||"",r=a?s?"".concat(a," - ").concat(s):a:"",o=e.nombreContacto||"",n=e.acontecimiento||"",l="15_anos"===n?"15 a\xf1os":"cumpleanos"===n?"Cumplea\xf1os":"boda"===n?"Boda":"otros"===n?"Otro":n,i=l?"".concat(o," - ").concat(l):o;return{Fecha:new Date(e.start).toLocaleDateString("es-ES"),Horario:"".concat(e4(e.start)," - ").concat(e4(e.end)),"Servicio/Espacio":(()=>{let t=e_(e);return t.hasSpace?"".concat(t.serviceName," - ").concat(t.spaceName):t.serviceName})(),Evento:r,Contacto:i,Teléfono:e.contacto||"",Monto:e.montoTotal||0,Saldo:(e.montoTotal||0)-((null===(t=J[e.id])||void 0===t?void 0:t.totalPagado)||0),APA:e.requiereApa?e.apaEstado||"Pendiente":"No aplica"}}),a=e.utils.json_to_sheet(t),s=e.utils.book_new();e.utils.book_append_sheet(s,a,"Reservas"),e.writeFile(s,"reservas_".concat(new Date().toISOString().slice(0,10),".xlsx"))})},className:"inline-flex items-center px-4 py-2 bg-green-600 text-white rounded-lg shadow hover:bg-green-700 transition-colors text-sm font-semibold",children:"Excel"}),(0,s.jsx)("button",{onClick:h,className:"inline-flex items-center px-4 py-2 bg-red-600 text-white rounded-lg shadow hover:bg-red-700 transition-colors text-sm font-semibold",children:"PDF"})]}),A?(0,s.jsx)("div",{className:"p-12 text-center",children:(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center space-y-4",children:[(0,s.jsx)("div",{className:"relative",children:(0,s.jsx)("div",{className:"w-12 h-12 border-4 border-slate-200 border-t-blue-600 rounded-full animate-spin"})}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("p",{className:"text-lg font-semibold text-slate-700",children:"Cargando reservas"}),(0,s.jsx)("p",{className:"text-sm text-slate-500",children:"Obteniendo informaci\xf3n actualizada..."})]})]})}):0===f.length?(0,s.jsx)("div",{className:"p-12 text-center",children:(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center space-y-6",children:[(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("div",{className:"w-20 h-20 bg-slate-100 rounded-full flex items-center justify-center"}),(0,s.jsx)("div",{className:"absolute -top-1 -right-1 w-6 h-6 bg-blue-100 rounded-full flex items-center justify-center",children:(0,s.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-slate-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[(0,s.jsx)("circle",{cx:"11",cy:"11",r:"8",stroke:"currentColor",strokeWidth:"2",fill:"none"}),(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-4.35-4.35"})]})})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("h3",{className:"text-xl font-semibold text-slate-700",children:"Sin reservas para este per\xedodo"}),(0,s.jsx)("p",{className:"text-slate-500 max-w-md mx-auto",children:"No se encontraron reservas con los filtros actuales. Las nuevas reservas aparecer\xe1n aqu\xed autom\xe1ticamente."})]}),(0,s.jsx)("div",{className:"flex items-center gap-2 text-sm text-slate-400",children:(0,s.jsx)("span",{children:"Tip: Intenta cambiar los filtros o el per\xedodo de fechas"})})]})}):(0,s.jsx)("div",{className:"overflow-x-auto",children:(0,s.jsxs)("table",{className:"w-full",children:[(0,s.jsx)("thead",{className:"bg-gradient-to-r from-slate-50 to-slate-100 border-b border-slate-200",children:(0,s.jsxs)("tr",{className:"text-xs uppercase tracking-wide text-slate-700",children:[(0,s.jsx)("th",{className:"px-3 sm:px-6 py-4 text-left font-bold",children:(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-slate-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),"Fecha & Horario"]})}),(0,s.jsx)("th",{className:"hidden lg:table-cell px-6 py-4 text-left font-bold",children:(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-slate-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})}),"Servicio/Espacio"]})}),(0,s.jsx)("th",{className:"hidden lg:table-cell px-6 py-4 text-left font-bold",children:(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-slate-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 14v3m4-3v3m4-3v3M3 21h18M3 10h18M3 7l9-4 9 4M4 10h16v11H4V10z"})}),"Evento"]})}),(0,s.jsx)("th",{className:"px-3 sm:px-6 py-4 text-left font-bold",children:(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-slate-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),"Contacto"]})}),(0,s.jsx)("th",{className:"hidden lg:table-cell px-6 py-4 text-left font-bold",children:(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-slate-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"})}),"Monto"]})}),(0,s.jsx)("th",{className:"hidden lg:table-cell px-6 py-4 text-left font-bold",children:(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-slate-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Saldo"]})}),(0,s.jsx)("th",{className:"hidden sm:table-cell px-6 py-4 text-center font-bold",children:(0,s.jsxs)("div",{className:"flex items-center justify-center gap-2",children:[(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-slate-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"APA"]})}),(0,s.jsx)("th",{className:"px-3 sm:px-6 py-4 text-right font-bold",children:(0,s.jsxs)("div",{className:"flex items-center justify-end gap-2",children:[(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-slate-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 5v.01M12 12v.01M12 19v.01M12 6a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2z"})}),"Acciones"]})})]})}),(0,s.jsx)("tbody",{className:"divide-y divide-slate-200",children:f.map(e=>{var t,a;return(0,s.jsxs)("tr",{className:"hover:bg-slate-50 transition-all duration-200 hover:shadow-sm border-b border-slate-100",children:[(0,s.jsx)("td",{className:"px-3 sm:px-6 py-3 sm:py-4",children:(0,s.jsx)("div",{className:"flex items-center gap-2",children:(0,s.jsxs)("div",{className:"min-w-0",children:[(0,s.jsx)("div",{className:"text-xs sm:text-sm font-bold text-slate-900",children:new Date(e.start).toLocaleDateString("es-ES",{day:"2-digit",month:"short"})}),(0,s.jsxs)("div",{className:"text-xs text-slate-600",children:[e4(e.start),"–",e4(e3(e)),(0,s.jsxs)("span",{className:"text-slate-400 ml-1",children:["(",e.horaExtra&&e.cantidadHorasExtra?"".concat(e.cantidadHorasExtra,"h"):"0h",")"]})]})]})})}),(0,s.jsx)("td",{className:"hidden lg:table-cell px-6 py-4",children:(0,s.jsx)("div",{className:"min-w-0",children:(0,s.jsx)("div",{className:"text-sm font-medium text-slate-900 truncate",children:(()=>{let t=e_(e);return(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"font-semibold text-slate-900",children:t.serviceName}),t.hasSpace&&t.spaceName!==t.serviceName&&(0,s.jsx)("div",{className:"text-xs text-slate-500",children:t.spaceName})]})})()})})}),(0,s.jsx)("td",{className:"hidden lg:table-cell px-6 py-4",children:e.acontecimiento?(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-sm font-medium capitalize text-slate-900",children:"15_anos"===e.acontecimiento?"Quincea\xf1era":"boda"===e.acontecimiento?"Boda":"cumpleanos"===e.acontecimiento?"Cumplea\xf1os":"Otro"}),(0,s.jsx)("div",{className:"text-xs text-slate-500 truncate max-w-[120px]",children:e.quinceaneraFocusNombre||e.noviosNombres||e.cumpleaneroNombre||e.otrosNombrePersona||""})]}):(0,s.jsx)("span",{className:"text-xs italic text-slate-400",children:"Sin especificar"})}),(0,s.jsx)("td",{className:"px-3 sm:px-6 py-3 sm:py-4",children:(0,s.jsx)("div",{className:"flex items-center gap-1 sm:gap-2",children:(0,s.jsxs)("div",{className:"min-w-0",children:[(0,s.jsx)("div",{className:"text-xs sm:text-sm font-semibold text-slate-900 truncate",children:e.nombreContacto||"—"}),(0,s.jsx)("div",{className:"sm:hidden text-[10px] text-slate-500",children:(()=>{let t=e_(e);return t.serviceName===t.spaceName?t.serviceName:"".concat(t.serviceName," - ").concat(t.spaceName)})()}),e.esParaTercero&&(0,s.jsxs)("div",{className:"md:hidden text-[10px] text-purple-600 font-medium",children:["\uD83D\uDC64 Para: ",e.terceroNombre]}),e.acontecimiento&&(0,s.jsxs)("div",{className:"text-[10px] text-blue-600 font-medium",children:["Evento especial: ","15_anos"===e.acontecimiento?"15 a\xf1os":"cumpleanos"===e.acontecimiento?"Cumplea\xf1os":"boda"===e.acontecimiento?"Boda":"otros"===e.acontecimiento?"Otro":e.acontecimiento]}),(0,s.jsx)("div",{className:"text-xs text-slate-500",children:e.contacto?"".concat(e.medioContacto,": ").concat(e.contacto):"—"})]})})}),(0,s.jsx)("td",{className:"hidden lg:table-cell px-6 py-4 text-sm",children:(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsx)("div",{className:"font-semibold text-slate-900",children:(0,l.xG)(e.montoTotal||0)}),Number(e.adelanto)>0?(0,s.jsxs)("div",{className:"text-xs text-green-600 font-medium",children:["Adelanto: ",(0,l.xG)(Number(e.adelanto))]}):null]})}),(0,s.jsx)("td",{className:"hidden lg:table-cell px-6 py-4 text-sm",children:(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsx)("div",{className:"font-semibold text-amber-700",children:(0,l.xG)((e.montoTotal||0)-((null===(t=J[e.id])||void 0===t?void 0:t.totalPagado)||0))}),(null===(a=J[e.id])||void 0===a?void 0:a.totalPagado)>0&&(0,s.jsxs)("div",{className:"text-xs text-green-600 font-medium",children:["Pagado: ",(0,l.xG)(J[e.id].totalPagado)]})]})}),(0,s.jsx)("td",{className:"hidden sm:table-cell px-6 py-4 text-center",children:e.requiereApa?(0,s.jsxs)("div",{className:"flex flex-col items-center gap-1",children:[(0,s.jsx)("button",{onClick:()=>{ed(e),en(!0)},className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium transition-all duration-200 hover:scale-105 cursor-pointer ".concat("APROBADO"===e.apaEstado?"bg-green-100 text-green-800 hover:bg-green-200":"ENTREGADO"===e.apaEstado?"bg-blue-100 text-blue-800 hover:bg-blue-200":"bg-yellow-100 text-yellow-800 hover:bg-yellow-200"),title:"APROBADO"===e.apaEstado?"APA Aprobado - Clic para gestionar":"ENTREGADO"===e.apaEstado?"APA Entregado - Clic para gestionar":"APA Pendiente - Clic para gestionar",children:"APROBADO"===e.apaEstado?"✅":"ENTREGADO"===e.apaEstado?"\uD83D\uDCE4":"⏳"}),e.apaComprobante&&(0,s.jsx)("a",{href:e.apaComprobante,target:"_blank",rel:"noopener noreferrer",className:"text-xs text-blue-600 hover:text-blue-800",title:"Ver comprobante APA",children:"Ver archivo"})]}):(0,s.jsx)("span",{className:"text-xs text-slate-400",children:"No aplica"})}),(0,s.jsx)("td",{className:"px-3 sm:px-6 py-3 sm:py-4 text-right",children:(0,s.jsxs)("div",{className:"flex items-center justify-end gap-0.5",children:[(0,s.jsxs)("div",{className:"group relative",children:[(0,s.jsx)("button",{onClick:()=>e5(e),className:"p-2 text-slate-400 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-all duration-200 hover:scale-105 hover:shadow-sm",children:(0,s.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})}),(0,s.jsx)("div",{className:"absolute bottom-full mb-2 left-1/2 transform -translate-x-1/2 px-2 py-1 bg-gray-900 text-white text-xs rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-10",children:"Ver detalles completos"})]}),(0,s.jsxs)("div",{className:"group relative",children:[(0,s.jsx)("button",{onClick:()=>e6(e),className:"p-2 text-slate-400 hover:text-green-600 hover:bg-green-50 rounded-lg transition-all duration-200 hover:scale-105 hover:shadow-sm",children:(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})}),(0,s.jsx)("div",{className:"absolute bottom-full mb-2 left-1/2 transform -translate-x-1/2 px-2 py-1 bg-gray-900 text-white text-xs rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-10",children:"Editar informaci\xf3n"})]}),(0,s.jsxs)("div",{className:"group relative",children:[(0,s.jsx)("button",{onClick:()=>e7(e),className:"p-2 text-slate-400 hover:text-red-600 hover:bg-red-50 rounded-lg transition-all duration-200 hover:scale-105 hover:shadow-sm",children:(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})}),(0,s.jsx)("div",{className:"absolute bottom-full mb-2 left-1/2 transform -translate-x-1/2 px-2 py-1 bg-gray-900 text-white text-xs rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-10",children:"Cancelar reserva"})]})]})})]},e.id)})})]})})]}),es&&ec&&(0,s.jsx)("div",{className:"fixed inset-0 z-50 bg-black/50 flex items-center justify-center p-4",onClick:e8,children:(0,s.jsxs)("div",{className:"w-full max-w-4xl max-h-[90vh] overflow-y-auto bg-white rounded-lg shadow",onClick:e=>e.stopPropagation(),children:[(0,s.jsxs)("div",{className:"flex items-center justify-between p-4 border-b",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-slate-800",children:"Editar Reserva"}),(0,s.jsx)("button",{onClick:e8,className:"text-gray-400 hover:text-gray-600",children:(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,s.jsxs)("div",{className:"p-4 space-y-4",children:[(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide",children:"Servicio/Espacio *"}),(0,s.jsxs)("select",{value:ef.resourceId,onChange:e=>eN(t=>({...t,resourceId:e.target.value})),className:"mt-1 w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,s.jsx)("option",{value:"",children:"— Seleccionar —"}),g.map(e=>(0,s.jsx)("option",{value:e.id,children:e.nombre},e.id))]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide",children:"Fecha *"}),(0,s.jsx)("input",{type:"date",value:ef.fecha,onChange:e=>eN(t=>({...t,fecha:e.target.value})),className:"mt-1 w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide",children:"Horario"}),(0,s.jsxs)("div",{className:"mt-1 grid grid-cols-2 gap-2",children:[(0,s.jsx)("input",{type:"time",value:ef.inicioHora,onChange:e=>eN(t=>({...t,inicioHora:e.target.value})),className:"w-full px-2 py-2 border border-gray-300 rounded-md text-sm",placeholder:"Inicio"}),(0,s.jsx)("input",{type:"time",value:ef.finHora,onChange:e=>eN(t=>({...t,finHora:e.target.value})),className:"w-full px-2 py-2 border border-gray-300 rounded-md text-sm",placeholder:"Fin"})]})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide",children:"Contacto"}),(0,s.jsx)("input",{type:"text",value:ef.nombreContacto,onChange:e=>eN(t=>({...t,nombreContacto:e.target.value})),className:"mt-1 w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Nombre del contacto"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide",children:"Tel\xe9fono"}),(0,s.jsx)("input",{type:"text",value:ef.contacto,onChange:e=>eN(t=>({...t,contacto:e.target.value})),className:"mt-1 w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"N\xfamero de tel\xe9fono"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide",children:"Estado"}),(0,s.jsxs)("select",{value:ef.status||"ACTIVO",onChange:e=>eN(t=>({...t,status:e.target.value})),className:"mt-1 w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,s.jsx)("option",{value:"ACTIVO",children:"Activo"}),(0,s.jsx)("option",{value:"CONFIRMED",children:"Confirmado"}),(0,s.jsx)("option",{value:"PENDING",children:"Pendiente"}),(0,s.jsx)("option",{value:"CULMINADO",children:"Culminado"}),(0,s.jsx)("option",{value:"CANCELADO",children:"Cancelado"})]})]})]}),(0,s.jsxs)("div",{className:"bg-slate-50 rounded-lg p-3",children:[(0,s.jsx)("h4",{className:"text-xs font-semibold text-slate-600 uppercase tracking-wide mb-2",children:"\uD83D\uDCB0 Informaci\xf3n Financiera"}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"text-xs text-gray-500",children:"Monto Total (Gs.)"}),(0,s.jsx)("input",{type:"text",value:ef.montoTotal?parseInt(ef.montoTotal).toLocaleString("de-DE"):"",onChange:e=>{let t=e.target.value.replace(/\./g,"");/^\d*$/.test(t)&&eN(e=>({...e,montoTotal:t}))},className:"mt-1 w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"0"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"text-xs text-gray-500",children:"Pagos Realizados (Gs.)"}),(0,s.jsxs)("p",{className:"mt-1 text-sm font-medium text-gray-900 py-2",children:[(0,l.xG)((null===(t=J[ec.id])||void 0===t?void 0:t.totalPagado)||0),(null===(c=J[ec.id])||void 0===c?void 0:c.pagosCount)>0&&ec.montoTotal&&(0,s.jsxs)("span",{className:"text-gray-500 text-xs ml-1",children:["(",Math.round(J[ec.id].totalPagado/ec.montoTotal*100),"%)"]})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"text-xs text-gray-500",children:"Saldo"}),(0,s.jsx)("p",{className:"mt-1 text-sm font-bold text-amber-700 py-2",children:(0,l.xG)(Math.max(0,(parseInt(ef.montoTotal.replace(/\./g,""))||0)-((null===(d=J[ec.id])||void 0===d?void 0:d.totalPagado)||0)))})]})]})]}),(0,s.jsxs)("div",{className:"bg-blue-50 rounded-lg p-3",children:[(0,s.jsx)("h4",{className:"text-xs font-semibold text-blue-700 uppercase tracking-wide mb-2",children:"\uD83C\uDF89 Informaci\xf3n del Evento"}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"text-xs text-blue-600",children:"Tipo de Evento"}),(0,s.jsxs)("select",{value:ef.acontecimiento||"",onChange:e=>eN(t=>({...t,acontecimiento:e.target.value})),className:"mt-1 w-full px-3 py-2 border border-blue-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,s.jsx)("option",{value:"",children:"Sin evento espec\xedfico"}),(0,s.jsx)("option",{value:"15_anos",children:"Quincea\xf1era"}),(0,s.jsx)("option",{value:"boda",children:"Boda"}),(0,s.jsx)("option",{value:"cumpleanos",children:"Cumplea\xf1os"}),(0,s.jsx)("option",{value:"otro",children:"Otro"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"text-xs text-blue-600",children:"Nombre de la persona"}),(0,s.jsx)("input",{type:"text",value:ef.quinceaneraFocusNombre||ef.noviosNombres||ef.cumpleaneroNombre||ef.otrosNombrePersona||"",onChange:e=>{let t=e.target.value;eN(e=>{let a={...e};return"15_anos"===ef.acontecimiento?a.quinceaneraFocusNombre=t:"boda"===ef.acontecimiento?a.noviosNombres=t:"cumpleanos"===ef.acontecimiento?a.cumpleaneroNombre=t:a.otrosNombrePersona=t,a})},className:"mt-1 w-full px-3 py-2 border border-blue-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Nombre de la quincea\xf1era, novios, etc."})]})]}),"otro"===ef.acontecimiento&&(0,s.jsxs)("div",{className:"mt-2",children:[(0,s.jsx)("label",{className:"text-xs text-blue-600",children:"Descripci\xf3n del evento"}),(0,s.jsx)("input",{type:"text",value:ef.otrosDescripcion||"",onChange:e=>eN(t=>({...t,otrosDescripcion:e.target.value})),className:"mt-1 w-full px-3 py-2 border border-blue-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Describe el tipo de evento"})]})]}),(0,s.jsxs)("div",{className:"bg-purple-50 rounded-lg p-3",children:[(0,s.jsxs)("h4",{className:"text-xs font-semibold text-purple-700 uppercase tracking-wide mb-2 flex items-center gap-2",children:["\uD83D\uDC64 Reserva para Tercero",(0,s.jsxs)("label",{className:"flex items-center text-xs",children:[(0,s.jsx)("input",{type:"checkbox",checked:ef.esParaTercero||!1,onChange:e=>eN(t=>({...t,esParaTercero:e.target.checked})),className:"mr-1"}),"Es para tercero"]})]}),ef.esParaTercero&&(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"text-xs text-purple-600",children:"Nombre"}),(0,s.jsx)("input",{type:"text",value:ef.terceroNombre||"",onChange:e=>eN(t=>({...t,terceroNombre:e.target.value})),className:"mt-1 w-full px-3 py-2 border border-purple-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500",placeholder:"Nombre del tercero"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"text-xs text-purple-600",children:"C\xe9dula"}),(0,s.jsx)("input",{type:"text",value:ef.terceroCedula||"",onChange:e=>eN(t=>({...t,terceroCedula:e.target.value})),className:"mt-1 w-full px-3 py-2 border border-purple-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500",placeholder:"N\xfamero de c\xe9dula"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"text-xs text-purple-600",children:"Tel\xe9fono"}),(0,s.jsx)("input",{type:"text",value:ef.terceroTelefono||"",onChange:e=>eN(t=>({...t,terceroTelefono:e.target.value})),className:"mt-1 w-full px-3 py-2 border border-purple-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500",placeholder:"Tel\xe9fono del tercero"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"text-xs text-purple-600",children:"RUC"}),(0,s.jsx)("input",{type:"text",value:ef.terceroRuc||"",onChange:e=>eN(t=>({...t,terceroRuc:e.target.value})),className:"mt-1 w-full px-3 py-2 border border-purple-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500",placeholder:"RUC del tercero"})]})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{className:"bg-green-50 rounded-lg p-3",children:[(0,s.jsx)("h4",{className:"text-xs font-semibold text-green-700 uppercase tracking-wide mb-2",children:"\uD83D\uDCDD Info Adicional"}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"text-xs text-green-600",children:"Cantidad de Personas"}),(0,s.jsx)("input",{type:"number",value:ef.cantidadPersonas||"",onChange:e=>eN(t=>({...t,cantidadPersonas:e.target.value})),className:"mt-1 w-full px-3 py-2 border border-green-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500",placeholder:"N\xfamero de invitados"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"text-xs text-green-600",children:"Observaciones"}),(0,s.jsx)("textarea",{value:ef.observacionesGenerales||"",onChange:e=>eN(t=>({...t,observacionesGenerales:e.target.value})),className:"mt-1 w-full px-3 py-2 border border-green-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500",rows:2,placeholder:"Observaciones generales"})]})]})]}),(0,s.jsxs)("div",{className:"bg-amber-50 rounded-lg p-3",children:[(0,s.jsx)("h4",{className:"text-xs font-semibold text-amber-700 uppercase tracking-wide mb-2",children:"\uD83D\uDD27 Extras y Requisitos"}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("label",{className:"flex items-center text-xs text-amber-600",children:[(0,s.jsx)("input",{type:"checkbox",checked:ef.horaExtra||!1,onChange:e=>eN(t=>({...t,horaExtra:e.target.checked})),className:"mr-2"}),"Requiere horas extra"]}),ef.horaExtra&&(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"text-xs text-amber-600",children:"Cantidad (horas)"}),(0,s.jsx)("input",{type:"number",value:ef.cantidadHorasExtra||1,onChange:e=>eN(t=>({...t,cantidadHorasExtra:parseInt(e.target.value)})),className:"mt-1 w-full px-2 py-1 border border-amber-300 rounded-md text-sm",min:"1"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"text-xs text-amber-600",children:"Monto Extra (Gs.)"}),(0,s.jsx)("input",{type:"text",value:ef.montoHorasExtra?parseInt(ef.montoHorasExtra.toString()).toLocaleString("de-DE"):"0",onChange:e=>{let t=e.target.value.replace(/\./g,"");/^\d*$/.test(t)&&eN(e=>({...e,montoHorasExtra:parseInt(t)||0}))},className:"mt-1 w-full px-2 py-1 border border-amber-300 rounded-md text-sm"})]})]}),(0,s.jsxs)("label",{className:"flex items-center text-xs text-amber-600",children:[(0,s.jsx)("input",{type:"checkbox",checked:ef.requiereApa||!1,onChange:e=>eN(t=>({...t,requiereApa:e.target.checked})),className:"mr-2"}),"Requiere APA"]}),ef.requiereApa&&(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"text-xs text-amber-600",children:"Estado APA"}),(0,s.jsxs)("select",{value:ef.apaEstado||"PENDIENTE",onChange:e=>eN(t=>({...t,apaEstado:e.target.value})),className:"mt-1 w-full px-2 py-1 border border-amber-300 rounded-md text-sm",children:[(0,s.jsx)("option",{value:"PENDIENTE",children:"Pendiente"}),(0,s.jsx)("option",{value:"ENTREGADO",children:"Entregado"}),(0,s.jsx)("option",{value:"APROBADO",children:"Aprobado"}),(0,s.jsx)("option",{value:"RECHAZADO",children:"Rechazado"})]})]})]})]})]}),(0,s.jsxs)("div",{className:"bg-gray-50 rounded-lg p-3",children:[(0,s.jsx)("label",{className:"text-xs font-semibold text-gray-600 uppercase tracking-wide",children:"\uD83D\uDCDD Notas"}),(0,s.jsx)("textarea",{value:ef.notas,onChange:e=>eN(t=>({...t,notas:e.target.value})),className:"mt-2 w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",rows:3,placeholder:"Notas adicionales sobre la reserva"})]})]}),(0,s.jsxs)("div",{className:"p-4 border-t bg-slate-50 flex justify-end gap-2",children:[(0,s.jsx)("button",{onClick:e8,className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 text-sm font-medium text-gray-700 transition-colors",children:"Cancelar"}),(0,s.jsx)("button",{onClick:()=>te(),disabled:em,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 text-sm font-medium transition-colors disabled:opacity-50",children:em?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 mr-1 inline animate-spin",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[(0,s.jsx)("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:4,d:"M4 12a8 8 0 018-8"})]}),"Actualizando…"]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 mr-1 inline",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Actualizar Reserva"]})})]})]})}),et&&ec&&(0,s.jsx)("div",{className:"fixed inset-0 z-50 bg-black/50 flex items-center justify-center p-4",onClick:e8,children:(0,s.jsxs)("div",{className:"w-full max-w-4xl max-h-[85vh] overflow-y-auto bg-white rounded-lg shadow",onClick:e=>e.stopPropagation(),children:[(0,s.jsxs)("div",{className:"flex items-center justify-between p-3 border-b bg-slate-50",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-slate-800",children:"\uD83D\uDCCB Detalles de Reserva"}),(0,s.jsx)("button",{onClick:e8,className:"text-gray-400 hover:text-gray-600 p-1 rounded-full hover:bg-gray-200 transition-colors","aria-label":"Cerrar",children:(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,s.jsxs)("div",{className:"p-4 space-y-3",children:[(0,s.jsxs)("div",{className:"grid grid-cols-2 lg:grid-cols-3 gap-x-4 gap-y-2",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide",children:"Servicio/Espacio"}),(0,s.jsx)("p",{className:"text-sm font-medium text-gray-900",children:(()=>{let e=e_(ec);return e.hasSpace?"".concat(e.serviceName," - ").concat(e.spaceName):e.serviceName})()})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide",children:"Fecha"}),(0,s.jsx)("p",{className:"text-sm font-medium text-gray-900",children:new Date(ec.start).toLocaleDateString()})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide",children:"Horario"}),(0,s.jsxs)("p",{className:"text-sm font-medium text-gray-900",children:[e4(ec.start)," - ",e4(e3(ec)),(0,s.jsxs)("span",{className:"text-gray-500 text-xs ml-1",children:["(",ec.horaExtra&&ec.cantidadHorasExtra?"+".concat(ec.cantidadHorasExtra,"h extra"):"Sin horas extra",")"]})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide",children:"Contacto"}),(0,s.jsx)("p",{className:"text-sm font-medium text-gray-900",children:ec.nombreContacto||"—"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide",children:"Medio"}),(0,s.jsx)("p",{className:"text-sm text-gray-700",children:ec.contacto?"".concat(ec.medioContacto,": ").concat(ec.contacto):"—"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide",children:"Estado"}),(0,s.jsx)("div",{className:"mt-0.5",children:function(e){let t=e;"ACTIVE"===e||"RESERVADO"===e||"PENDING"===e?t="ACTIVO":"COMPLETED"===e?t="CULMINADO":"CANCELED"===e&&(t="CANCELADO");let a=t;return(0,s.jsxs)("span",{className:"".concat("inline-flex items-center gap-1 px-2.5 py-1 rounded-full text-xs font-semibold shadow-sm"," ").concat({ACTIVO:"bg-emerald-100 border border-emerald-200 text-emerald-700",CULMINADO:"bg-blue-100 border border-blue-200 text-blue-700",CANCELADO:"bg-red-100 border border-red-200 text-red-700",HOLD:"bg-amber-100 border border-amber-200 text-amber-700",PENDING:"bg-slate-100 border border-slate-200 text-slate-700",CONFIRMED:"bg-emerald-100 border border-emerald-200 text-emerald-700",COMPLETED:"bg-blue-100 border border-blue-200 text-blue-700",CANCELED:"bg-red-100 border border-red-200 text-red-700"}[a]||"bg-slate-100 border border-slate-200 text-slate-700"),children:[(0,s.jsx)("span",{className:"text-[10px]",children:{ACTIVO:"✅",CULMINADO:"\uD83C\uDFC1",CANCELADO:"❌",HOLD:"⏳",PENDING:"⏱️",CONFIRMED:"✅",COMPLETED:"\uD83C\uDFC1",CANCELED:"❌"}[a]||"•"}),(0,s.jsx)("span",{children:{ACTIVO:"Activo",CULMINADO:"Culminado",CANCELADO:"Cancelado",HOLD:"En Espera",PENDING:"Pendiente",CONFIRMED:"Confirmada",COMPLETED:"Completada",CANCELED:"Cancelada"}[a]||a})]})}(ec.status)})]})]}),(0,s.jsxs)("div",{className:"bg-slate-50 rounded-lg p-3",children:[(0,s.jsx)("h4",{className:"text-xs font-semibold text-slate-600 uppercase tracking-wide mb-2",children:"\uD83D\uDCB0 Informaci\xf3n Financiera"}),(0,s.jsxs)("div",{className:"grid grid-cols-2 lg:grid-cols-3 gap-x-4 gap-y-2",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"text-xs text-gray-500",children:"Monto Total"}),(0,s.jsx)("p",{className:"text-sm font-bold text-gray-900",children:(0,l.xG)(ec.montoTotal||0)})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"text-xs text-gray-500",children:"Pagos Realizados"}),(0,s.jsxs)("p",{className:"text-sm font-medium text-gray-900",children:[(0,l.xG)((null===(m=J[ec.id])||void 0===m?void 0:m.totalPagado)||0),(null===(x=J[ec.id])||void 0===x?void 0:x.pagosCount)>0&&ec.montoTotal&&(0,s.jsxs)("span",{className:"text-gray-500 text-xs ml-1",children:["(",Math.round(J[ec.id].totalPagado/ec.montoTotal*100),"%)"]})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"text-xs text-gray-500",children:"Saldo"}),(0,s.jsx)("p",{className:"text-sm font-bold text-amber-700",children:(0,l.xG)((ec.montoTotal||0)-((null===(u=J[ec.id])||void 0===u?void 0:u.totalPagado)||0))})]})]})]}),(0,s.jsxs)("div",{className:"space-y-3",children:[ec.acontecimiento&&(0,s.jsxs)("div",{className:"bg-blue-50 rounded-lg p-3",children:[(0,s.jsx)("h4",{className:"text-xs font-semibold text-blue-700 uppercase tracking-wide mb-2 flex items-center gap-1",children:"\uD83C\uDF89 Informaci\xf3n del Evento"}),(0,s.jsxs)("div",{className:"grid grid-cols-2 lg:grid-cols-3 gap-x-4 gap-y-1",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"text-xs text-blue-600",children:"Tipo"}),(0,s.jsx)("p",{className:"text-sm font-medium text-blue-900 capitalize",children:"15_anos"===ec.acontecimiento?"Quincea\xf1era":"boda"===ec.acontecimiento?"Boda":"cumpleanos"===ec.acontecimiento?"Cumplea\xf1os":"Otro"})]}),ec.quinceaneraFocusNombre&&(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"text-xs text-blue-600",children:"Quincea\xf1era"}),(0,s.jsx)("p",{className:"text-sm text-blue-900",children:ec.quinceaneraFocusNombre})]}),ec.noviosNombres&&(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"text-xs text-blue-600",children:"Novios"}),(0,s.jsx)("p",{className:"text-sm text-blue-900",children:ec.noviosNombres})]}),ec.cumpleaneroNombre&&(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"text-xs text-blue-600",children:"Cumplea\xf1ero/a"}),(0,s.jsx)("p",{className:"text-sm text-blue-900",children:ec.cumpleaneroNombre})]}),ec.otrosNombrePersona&&(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"text-xs text-blue-600",children:"Contacto evento"}),(0,s.jsx)("p",{className:"text-sm text-blue-900",children:ec.otrosNombrePersona})]})]}),ec.otrosDescripcion&&(0,s.jsxs)("div",{className:"mt-2",children:[(0,s.jsx)("label",{className:"text-xs text-blue-600",children:"Descripci\xf3n"}),(0,s.jsx)("p",{className:"text-sm text-blue-900",children:ec.otrosDescripcion})]})]}),ec.esParaTercero&&(0,s.jsxs)("div",{className:"bg-purple-50 rounded-lg p-3",children:[(0,s.jsx)("h4",{className:"text-xs font-semibold text-purple-700 uppercase tracking-wide mb-2 flex items-center gap-1",children:"\uD83D\uDC64 Reserva para Tercero"}),(0,s.jsxs)("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-x-4 gap-y-1",children:[ec.terceroNombre&&(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"text-xs text-purple-600",children:"Nombre"}),(0,s.jsx)("p",{className:"text-sm font-medium text-purple-900",children:ec.terceroNombre})]}),ec.terceroCedula&&(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"text-xs text-purple-600",children:"C\xe9dula"}),(0,s.jsx)("p",{className:"text-sm text-purple-900",children:ec.terceroCedula})]}),ec.terceroTelefono&&(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"text-xs text-purple-600",children:"Tel\xe9fono"}),(0,s.jsx)("p",{className:"text-sm text-purple-900",children:ec.terceroTelefono})]}),ec.terceroRuc&&(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"text-xs text-purple-600",children:"RUC"}),(0,s.jsx)("p",{className:"text-sm text-purple-900",children:ec.terceroRuc})]})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-3",children:[(ec.cantidadPersonas||ec.observacionesGenerales)&&(0,s.jsxs)("div",{className:"bg-green-50 rounded-lg p-3",children:[(0,s.jsx)("h4",{className:"text-xs font-semibold text-green-700 uppercase tracking-wide mb-2",children:"\uD83D\uDCDD Info Adicional"}),(0,s.jsxs)("div",{className:"space-y-1",children:[ec.cantidadPersonas&&(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"text-xs text-green-600",children:"Personas"}),(0,s.jsx)("p",{className:"text-sm font-medium text-green-900",children:ec.cantidadPersonas})]}),ec.observacionesGenerales&&(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"text-xs text-green-600",children:"Observaciones"}),(0,s.jsx)("p",{className:"text-sm text-green-900",children:ec.observacionesGenerales})]})]})]}),(ec.horaExtra||ec.requiereApa)&&(0,s.jsxs)("div",{className:"bg-amber-50 rounded-lg p-3",children:[(0,s.jsx)("h4",{className:"text-xs font-semibold text-amber-700 uppercase tracking-wide mb-2",children:"\uD83D\uDD27 Extras y Requisitos"}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-x-3 gap-y-1",children:[ec.horaExtra&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"text-xs text-amber-600",children:"Horas Extra"}),(0,s.jsxs)("p",{className:"text-sm font-medium text-amber-900",children:[ec.cantidadHorasExtra||0,"h"]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"text-xs text-amber-600",children:"Monto Extra"}),(0,s.jsx)("p",{className:"text-sm font-bold text-amber-900",children:(0,l.xG)(ec.montoHorasExtra||0)})]})]}),ec.requiereApa&&(0,s.jsx)(s.Fragment,{children:(0,s.jsxs)("div",{className:"col-span-2",children:[(0,s.jsx)("label",{className:"text-xs text-amber-600",children:"Estado APA"}),(0,s.jsxs)("div",{className:"flex items-center gap-2 mt-1",children:[(0,s.jsx)("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium ".concat("APROBADO"===ec.apaEstado?"bg-green-100 text-green-800":"ENTREGADO"===ec.apaEstado?"bg-blue-100 text-blue-800":"bg-yellow-100 text-yellow-800"),children:"APROBADO"===ec.apaEstado?"✅ Aprobado":"ENTREGADO"===ec.apaEstado?"\uD83D\uDCE4 Entregado":"⏳ Pendiente"}),(0,s.jsx)("button",{onClick:()=>en(!0),className:"inline-flex items-center gap-1 px-2 py-1 bg-amber-600 text-white text-xs rounded-md hover:bg-amber-700 transition-colors",children:"Gestionar"})]}),ec.apaComprobante&&(0,s.jsx)("div",{className:"mt-1",children:(0,s.jsx)("a",{href:ec.apaComprobante,target:"_blank",rel:"noopener noreferrer",className:"text-xs text-blue-600 hover:text-blue-800 flex items-center gap-1",children:"Ver comprobante"})})]})})]})]})]})]}),ec.notas&&(0,s.jsxs)("div",{className:"bg-gray-50 rounded-lg p-3",children:[(0,s.jsx)("label",{className:"text-xs font-semibold text-gray-600 uppercase tracking-wide",children:"\uD83D\uDCDD Notas"}),(0,s.jsx)("p",{className:"text-sm text-gray-700 mt-1",children:ec.notas})]}),(0,s.jsxs)("div",{className:"text-xs text-gray-500 pt-2 border-t border-gray-200 grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"font-medium",children:"Creada:"})," ",new Date(ec.createdAt).toLocaleDateString()]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"font-medium",children:"Actualizada:"})," ",new Date(ec.updatedAt).toLocaleDateString()]})]})]}),(0,s.jsxs)("div",{className:"p-3 border-t bg-slate-50 flex justify-end gap-2",children:[(0,s.jsx)("button",{onClick:e8,className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 text-sm font-medium text-gray-700 transition-colors",children:"Cerrar"}),(0,s.jsx)("button",{onClick:()=>{e8(),e6(ec)},className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 text-sm font-medium transition-colors",children:"Editar Reserva"})]})]})}),z&&(0,s.jsx)("div",{className:"fixed inset-0 z-50 bg-black/50 flex items-center justify-center p-4",onClick:()=>q(!1),children:(0,s.jsx)("div",{className:"w-full max-w-6xl bg-white rounded-lg shadow max-h-[90vh] overflow-y-auto",onClick:e=>e.stopPropagation(),children:(0,s.jsxs)("div",{className:"p-6",children:[(0,s.jsxs)("div",{className:"flex items-start justify-between mb-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-xl font-semibold text-gray-900",children:"\uD83D\uDCCB Historial de Reservas"}),(0,s.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:"Reservas culminadas y canceladas"})]}),(0,s.jsx)("button",{onClick:()=>q(!1),className:"text-gray-400 hover:text-gray-600 transition-colors p-1",children:(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,s.jsx)("div",{className:"mb-4",children:(0,s.jsxs)("div",{className:"flex gap-3 items-end",children:[(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Buscar en historial"}),(0,s.jsx)("input",{type:"text",value:Y,onChange:e=>Z(e.target.value),onKeyDown:e=>"Enter"===e.key&&eZ(),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Buscar por contacto, notas, etc..."})]}),(0,s.jsx)("button",{onClick:eZ,disabled:W,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors disabled:opacity-50",children:W?"Buscando...":"Buscar"})]})}),(0,s.jsx)("div",{className:"border rounded-lg overflow-hidden",children:(0,s.jsxs)("table",{className:"w-full",children:[(0,s.jsx)("thead",{className:"bg-gray-50",children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-600",children:"Fecha"}),(0,s.jsx)("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-600",children:"Servicio/Espacio"}),(0,s.jsx)("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-600",children:"Contacto"}),(0,s.jsx)("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-600",children:"Monto"}),(0,s.jsx)("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-600",children:"APA"}),(0,s.jsx)("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-600",children:"Estado"}),(0,s.jsx)("th",{className:"px-4 py-2 text-right text-xs font-medium text-gray-600",children:"Acciones"})]})}),(0,s.jsx)("tbody",{className:"divide-y",children:W?(0,s.jsx)("tr",{children:(0,s.jsx)("td",{colSpan:7,className:"px-4 py-12",children:(0,s.jsx)("div",{className:"flex flex-col items-center justify-center space-y-3",children:(0,s.jsx)("p",{className:"text-sm font-medium text-slate-600",children:"Cargando historial..."})})})}):0===V.length?(0,s.jsx)("tr",{children:(0,s.jsx)("td",{colSpan:7,className:"px-4 py-8 text-center text-gray-500",children:"No se encontraron reservas en el historial"})}):V.map(e=>{let t=e_(e),a=new Date(e.start);return(0,s.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,s.jsxs)("td",{className:"px-4 py-2",children:[(0,s.jsx)("div",{className:"text-sm font-medium",children:a.toLocaleDateString()}),(0,s.jsxs)("div",{className:"text-xs text-gray-500",children:[e4(e.start),"–",e4(e3(e))]})]}),(0,s.jsxs)("td",{className:"px-4 py-2",children:[(0,s.jsx)("div",{className:"text-sm font-medium",children:t.serviceName}),t.serviceName!==t.spaceName&&(0,s.jsx)("div",{className:"text-xs text-gray-500",children:t.spaceName})]}),(0,s.jsxs)("td",{className:"px-4 py-2",children:[(0,s.jsx)("div",{className:"text-sm font-medium",children:e.nombreContacto||"—"}),e.contacto&&(0,s.jsxs)("div",{className:"text-xs text-gray-500",children:[e.medioContacto,": ",e.contacto]})]}),(0,s.jsxs)("td",{className:"px-4 py-2",children:[(0,s.jsx)("div",{className:"text-sm font-medium text-gray-900",children:(0,l.xG)(e.montoTotal||0)}),Number(e.adelanto)>0&&(0,s.jsxs)("div",{className:"text-xs text-green-600",children:["Adelanto: ",(0,l.xG)(Number(e.adelanto))]})]}),(0,s.jsx)("td",{className:"px-4 py-2 text-center",children:e.requiereApa?(0,s.jsx)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ".concat("APROBADO"===e.apaEstado?"bg-green-100 text-green-800":"ENTREGADO"===e.apaEstado?"bg-blue-100 text-blue-800":"bg-yellow-100 text-yellow-800"),children:"APROBADO"===e.apaEstado?"✅":"ENTREGADO"===e.apaEstado?"\uD83D\uDCE4":"⏳"}):(0,s.jsx)("span",{className:"text-xs text-gray-400",children:"—"})}),(0,s.jsx)("td",{className:"px-4 py-2",children:(0,s.jsx)("span",{className:"border px-2 py-0.5 rounded text-xs font-medium ".concat(e2(e.status).className),children:e2(e.status).label})}),(0,s.jsx)("td",{className:"px-4 py-2 text-right",children:(0,s.jsx)("button",{onClick:()=>{confirm("\xbfEst\xe1s seguro de eliminar permanentemente esta reserva del historial?")&&e1(e.id)},className:"text-red-600 hover:text-red-800 text-sm font-medium",children:"Eliminar"})})]},e.id)})})]})})]})})}),eD&&ek&&(0,s.jsxs)("div",{className:"menu-action",style:{position:"fixed",top:ek.top,left:ek.left,minWidth:"12rem",background:"white",borderRadius:"0.5rem",boxShadow:"0 10px 40px rgba(0,0,0,0.25)",border:"1px solid #e5e7eb",zIndex:9999},children:[(0,s.jsx)("button",{onClick:()=>{eA(null),eT(null);let e=f.find(e=>e.id===eD);e&&e5(e)},className:"flex items-center gap-3 w-full text-left px-4 py-3 text-sm text-slate-700 hover:bg-slate-50 transition-colors duration-200",children:"Ver Detalles"}),(0,s.jsx)("button",{onClick:()=>{eA(null),eT(null);let e=f.find(e=>e.id===eD);e&&e6(e)},className:"flex items-center gap-3 w-full text-left px-4 py-3 text-sm text-blue-600 hover:bg-blue-50 transition-colors duration-200",children:"Editar"}),(0,s.jsx)("button",{onClick:()=>{eA(null),eT(null);let e=f.find(e=>e.id===eD);e&&e7(e)},className:"flex items-center gap-3 w-full text-left px-4 py-3 text-sm text-red-600 hover:bg-red-50 transition-colors duration-200 border-t border-slate-100",children:"Cancelar Reserva"})]}),eL&&eS&&(0,s.jsxs)("div",{className:"fixed bg-white border border-slate-200 rounded-xl shadow-lg z-50 p-4",style:{top:eS.top,left:eS.left,width:"450px"},children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,s.jsx)("h4",{className:"font-semibold text-slate-900",children:new Date(eL+"T00:00:00").toLocaleDateString("es-ES",{weekday:"long",day:"numeric",month:"long"})}),(0,s.jsxs)("span",{className:"bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded-full font-medium",children:[(null===(p=eK.get(eL))||void 0===p?void 0:p.length)||0," reservas"]})]}),(0,s.jsx)("div",{className:"max-h-80 overflow-y-auto space-y-2",children:(eK.get(eL)||[]).map(e=>{let t=e_(e),a=e2(e.status),r=t.serviceName===t.spaceName?t.serviceName:t.hasSpace?t.spaceName:t.serviceName,o=e.acontecimiento?"15_anos"===e.acontecimiento?"\uD83C\uDF89 Quincea\xf1era":"boda"===e.acontecimiento?"\uD83C\uDF89 Boda":"cumpleanos"===e.acontecimiento?"\uD83C\uDF89 Cumplea\xf1os":"\uD83C\uDF89 Evento":null;return(0,s.jsx)("div",{className:"border border-slate-200 rounded-lg px-3 py-2 hover:bg-slate-50 cursor-pointer transition-colors duration-200",onClick:()=>{eF(),e5(e)},children:(0,s.jsxs)("div",{className:"flex items-center justify-between text-xs",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 flex-1 min-w-0",children:[(0,s.jsx)("span",{className:"font-medium text-slate-900 truncate",children:r}),(0,s.jsx)("span",{className:"text-slate-400",children:"•"}),(0,s.jsxs)("span",{className:"text-slate-600 whitespace-nowrap",children:[e4(e.start)," - ",e4(e3(e))]}),o&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("span",{className:"text-slate-400",children:"•"}),(0,s.jsx)("span",{className:"text-blue-600 truncate",children:o})]})]}),(0,s.jsx)("span",{className:"border px-2 py-0.5 rounded-md text-xs font-medium ml-2 whitespace-nowrap ".concat(a.className),children:a.label})]})},e.id)})})]}),eo&&ec&&(0,s.jsx)(b,{reservationId:ec.id,currentFile:ec.apaComprobante,currentStatus:ec.apaEstado,isAdmin:!0,onClose:()=>{en(!1),ed(null)},onFileUploaded:eQ}),el&&ec&&(0,s.jsx)("div",{className:"fixed inset-0 z-50 bg-black/50 flex items-center justify-center p-4",onClick:e8,children:(0,s.jsxs)("div",{className:"w-full max-w-2xl bg-white rounded-lg shadow-xl",onClick:e=>e.stopPropagation(),children:[(0,s.jsxs)("div",{className:"flex items-center justify-between p-4 border-b bg-red-50",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-red-800 flex items-center gap-2",children:"❌ Cancelar Reserva"}),(0,s.jsx)("button",{onClick:e8,className:"text-gray-400 hover:text-gray-600 p-1 rounded-full hover:bg-gray-200 transition-colors",children:(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,s.jsxs)("div",{className:"p-6 space-y-6 max-h-[70vh] overflow-y-auto",children:[(0,s.jsxs)("div",{className:"bg-slate-50 rounded-lg p-4",children:[(0,s.jsx)("h4",{className:"font-semibold text-slate-700 mb-2",children:"Datos de la Reserva"}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-slate-500",children:"Espacio:"}),(0,s.jsx)("p",{className:"font-medium",children:(()=>{let e=e_(ec);return e.hasSpace?"".concat(e.serviceName," - ").concat(e.spaceName):e.serviceName})()})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-slate-500",children:"Fecha:"}),(0,s.jsx)("p",{className:"font-medium",children:new Date(ec.start).toLocaleDateString("es-ES")})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-slate-500",children:"Contacto:"}),(0,s.jsx)("p",{className:"font-medium",children:ec.nombreContacto})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-slate-500",children:"Monto Total:"}),(0,s.jsx)("p",{className:"font-bold text-lg",children:(0,l.xG)(ec.montoTotal)})]})]})]}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Motivo de Cancelaci\xf3n *"}),(0,s.jsx)("textarea",{value:eu.cancelReason,onChange:e=>ep(t=>({...t,cancelReason:e.target.value})),placeholder:"Explique el motivo de la cancelaci\xf3n...",rows:3,className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),(0,s.jsxs)("div",{className:"border-t pt-4",children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-3",children:"Tipo de Reembolso *"}),(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsxs)("label",{className:"flex items-start gap-3 p-3 border-2 rounded-lg cursor-pointer hover:bg-slate-50 transition-colors",style:{borderColor:"NINGUNO"===eu.refundType?"#dc2626":"#e2e8f0"},children:[(0,s.jsx)("input",{type:"radio",name:"refundType",value:"NINGUNO",checked:"NINGUNO"===eu.refundType,onChange:e=>ep(e=>({...e,refundType:"NINGUNO",refundAmount:"",penaltyAmount:""})),className:"mt-1 w-4 h-4 text-red-600"}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("div",{className:"font-medium text-slate-900",children:"Sin Reembolso"}),(0,s.jsxs)("p",{className:"text-xs text-slate-600 mt-1",children:["El club retiene todo lo pagado: ",(0,l.xG)(eh),". Se crea un d\xe9bito de penalizaci\xf3n."]}),eh<ec.montoTotal&&(0,s.jsxs)("p",{className:"text-xs text-amber-600 mt-1",children:["⚠️ Total reserva: ",(0,l.xG)(ec.montoTotal)," | Pagado: ",(0,l.xG)(eh)]})]})]}),(0,s.jsxs)("label",{className:"flex items-start gap-3 p-3 border-2 rounded-lg transition-colors ".concat(0===eh?"opacity-50 cursor-not-allowed bg-slate-100":"cursor-pointer hover:bg-slate-50"),style:{borderColor:"TOTAL"===eu.refundType?"#16a34a":"#e2e8f0"},children:[(0,s.jsx)("input",{type:"radio",name:"refundType",value:"TOTAL",checked:"TOTAL"===eu.refundType,onChange:e=>ep(e=>({...e,refundType:"TOTAL",refundAmount:"",penaltyAmount:""})),disabled:0===eh,className:"mt-1 w-4 h-4 text-green-600 disabled:opacity-50"}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("div",{className:"font-medium text-slate-900",children:"Reembolso Total"}),(0,s.jsx)("p",{className:"text-xs text-slate-600 mt-1",children:0===eh?"❌ No disponible: No hay pagos registrados":"Se devuelve todo lo pagado: ".concat((0,l.xG)(eh)," al socio. El club no retiene nada.")}),eh>0&&eh<ec.montoTotal&&(0,s.jsxs)("p",{className:"text-xs text-amber-600 mt-1",children:["⚠️ Total reserva: ",(0,l.xG)(ec.montoTotal)," | Pagado: ",(0,l.xG)(eh)]})]})]}),(0,s.jsxs)("label",{className:"flex items-start gap-3 p-3 border-2 rounded-lg transition-colors ".concat(0===eh?"opacity-50 cursor-not-allowed bg-slate-100":"cursor-pointer hover:bg-slate-50"),style:{borderColor:"PARCIAL"===eu.refundType?"#2563eb":"#e2e8f0"},children:[(0,s.jsx)("input",{type:"radio",name:"refundType",value:"PARCIAL",checked:"PARCIAL"===eu.refundType,onChange:e=>ep(e=>({...e,refundType:"PARCIAL"})),disabled:0===eh,className:"mt-1 w-4 h-4 text-blue-600 disabled:opacity-50"}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("div",{className:"font-medium text-slate-900",children:"Reembolso Parcial"}),(0,s.jsx)("p",{className:"text-xs text-slate-600 mt-1",children:0===eh?"❌ No disponible: No hay pagos registrados":"Se devuelve una parte al socio y el club retiene el resto como penalizaci\xf3n."}),"PARCIAL"===eu.refundType&&(0,s.jsxs)("div",{className:"mt-3 space-y-3 pl-3 border-l-2 border-blue-300",children:[0===eh&&(0,s.jsx)("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-2 text-xs text-amber-800",children:"⚠️ No hay pagos registrados. No se puede hacer reembolso parcial."}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-xs font-medium text-slate-700 mb-1",children:"Monto a Reembolsar (Gs.)"}),(0,s.jsx)("input",{type:"text",value:eu.refundAmount,onChange:e=>{let t=e.target.value.replace(/\D/g,""),a=eh-parseInt(t||"0");ep(e=>({...e,refundAmount:t,penaltyAmount:a.toString()}))},placeholder:"0",className:"w-full px-3 py-2 border border-blue-300 rounded-lg focus:ring-2 focus:ring-blue-500 text-sm"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-xs font-medium text-slate-700 mb-1",children:"Penalizaci\xf3n / Club Retiene (Gs.)"}),(0,s.jsx)("input",{type:"text",value:eu.penaltyAmount,onChange:e=>{let t=e.target.value.replace(/\D/g,""),a=eh-parseInt(t||"0");ep(e=>({...e,penaltyAmount:t,refundAmount:a.toString()}))},placeholder:"0",className:"w-full px-3 py-2 border border-red-300 rounded-lg focus:ring-2 focus:ring-red-500 text-sm"})]}),(0,s.jsxs)("div",{className:"bg-blue-50 rounded p-2 text-xs text-blue-800",children:[(0,s.jsx)("strong",{children:"Total:"})," ",(0,l.xG)(parseInt(eu.refundAmount||"0")+parseInt(eu.penaltyAmount||"0")),(0,s.jsxs)("span",{className:"text-blue-600 ml-2",children:["(debe ser igual a ",(0,l.xG)(eh),")"]})]}),eh<ec.montoTotal&&(0,s.jsxs)("div",{className:"bg-amber-50 border border-amber-200 rounded p-2 text-xs text-amber-700",children:["ℹ️ ",(0,s.jsx)("strong",{children:"Nota:"})," Total reserva: ",(0,l.xG)(ec.montoTotal)," | Total pagado: ",(0,l.xG)(eh)]})]})]})]})]})]})]})]}),(0,s.jsxs)("div",{className:"flex items-center justify-end gap-3 p-4 border-t bg-slate-50",children:[(0,s.jsx)("button",{onClick:e8,disabled:em,className:"px-4 py-2 text-slate-600 hover:text-slate-800 hover:bg-slate-200 rounded-lg transition-colors",children:"Cancelar"}),(0,s.jsx)("button",{onClick:e9,disabled:em||!eu.cancelReason.trim(),className:"px-6 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors font-medium",children:em?"Procesando...":"✅ Confirmar Cancelaci\xf3n"})]})]})})]})})})}},45365:function(e,t,a){"use strict";a.d(t,{D2:function(){return s},LJ:function(){return o},_4:function(){return n},tF:function(){return r}});let s={name:"America/Asuncion",offsetHours:-3,description:"Paraguay (UTC-3)"};function r(){let e=new Date,t=Object.fromEntries(new Intl.DateTimeFormat("en-CA",{timeZone:s.name,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}).formatToParts(e).map(e=>[e.type,e.value]));return new Date(parseInt(t.year),parseInt(t.month)-1,parseInt(t.day),parseInt(t.hour),parseInt(t.minute),parseInt(t.second))}function o(e){if(e){let t=e.getFullYear(),a=String(e.getMonth()+1).padStart(2,"0"),s=String(e.getDate()).padStart(2,"0");return"".concat(t,"-").concat(a,"-").concat(s)}{let e=new Date;return new Intl.DateTimeFormat("en-CA",{timeZone:s.name,year:"numeric",month:"2-digit",day:"2-digit"}).format(e)}}function n(e){let t,a=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if("string"==typeof e){if(/^\d{4}-\d{2}-\d{2}$/.test(e)){let[a,s,r]=e.split("-").map(Number);t=new Date(a,s-1,r)}else t=new Date(e)}else t=e;if(a)return t.toLocaleString("es-PY",{timeZone:s.name,day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit",hour12:!1});if(!("string"==typeof e&&/^\d{4}-\d{2}-\d{2}$/.test(e)))return t.toLocaleDateString("es-PY",{timeZone:s.name,day:"2-digit",month:"2-digit",year:"numeric"});{let[t,a,s]=e.split("-");return"".concat(s.padStart(2,"0"),"/").concat(a.padStart(2,"0"),"/").concat(t)}}},94508:function(e,t,a){"use strict";a.d(t,{Fw:function(){return n},Ji:function(){return l},m9:function(){return i},p6:function(){return o},sQ:function(){return d},sU:function(){return c},xG:function(){return r}});var s=a(45365);function r(e){return new Intl.NumberFormat("es-PY",{style:"currency",currency:"PYG",minimumFractionDigits:0}).format(e)}function o(e){return(0,s._4)(e,!1)}function n(e){let t=(0,s.tF)(),a=new Date(new Date(e).getTime()+108e5),r=t.getUTCFullYear()-a.getUTCFullYear(),o=t.getUTCMonth()-a.getUTCMonth();return(o<0||0===o&&t.getUTCDate()<a.getUTCDate())&&r--,r}function l(){return(0,s.LJ)()}function i(e){let t=e.replace(/\D/g,"");return t?t.replace(/\B(?=(\d{3})+(?!\d))/g,"."):""}function c(e){return parseInt(e.replace(/\./g,""))||0}function d(e){return Math.round(e)}},17689:function(e,t,a){"use strict";a.d(t,{Z:function(){return s}});let s=(0,a(39763).Z)("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]])},32489:function(e,t,a){"use strict";a.d(t,{Z:function(){return s}});let s=(0,a(39763).Z)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])}},function(e){e.O(0,[3643,9690,2971,2117,1744],function(){return e(e.s=91989)}),_N_E=e.O()}]);