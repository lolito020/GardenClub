(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2375],{84902:function(e,r,a){Promise.resolve().then(a.bind(a,41302))},41302:function(e,r,a){"use strict";a.r(r),a.d(r,{default:function(){return d}});var o=a(57437),s=a(69690),l=a(17985),t=a(2265),n=a(99376),i=a(32660),c=a(27648);function d(){let e=(0,n.useRouter)(),[r,a]=(0,t.useState)(!1),[d,m]=(0,t.useState)(""),[u,x]=(0,t.useState)([]),[g,p]=(0,t.useState)(!0),[b,f]=(0,t.useState)({nombres:"",apellidos:"",ci:"",telefono:"",celular:"",direccion:"",email:"",tipoCobrador:"EXTERNO",comisionPorDefecto:"12.5",formasPago:["efectivo"],cuentaBanco:""});async function h(){try{let e=await l.L.authenticatedFetch("/api/collectors"),r=await e.json();x(Array.isArray(r)?r:[])}catch(e){console.error("Error loading collectors:",e),x([])}finally{p(!1)}}(0,t.useEffect)(()=>{h()},[]);let y=u.some(e=>"CLUB"===e.tipoCobrador),j=e=>{"CLUB"===e?f(r=>({...r,tipoCobrador:e,nombres:"Garden Club",apellidos:"",ci:"",telefono:"",celular:"",direccion:"",email:"",formasPago:["efectivo","transferencia","cheque"],comisionPorDefecto:"0"})):f(r=>({...r,tipoCobrador:e,nombres:"CLUB"===r.tipoCobrador?"":r.nombres,formasPago:"CLUB"===r.tipoCobrador?["efectivo"]:r.formasPago}))},N=e=>{f(r=>{let a=r.formasPago;return a.includes(e)?{...r,formasPago:a.length>1?a.filter(r=>r!==e):a}:{...r,formasPago:[...a,e]}})},v=async r=>{r.preventDefault(),m(""),a(!0);try{let r={...b,comisionPorDefecto:"EXTERNO"===b.tipoCobrador||"PROFESOR"===b.tipoCobrador?parseFloat(b.comisionPorDefecto):void 0},a=await l.L.authenticatedFetch("/api/collectors",{method:"POST",body:JSON.stringify(r)}),o=await a.json();a.ok?e.push("/admin/cobradores"):m(o.msg||"Error al crear cobrador")}catch(e){m("Error de conexi\xf3n")}finally{a(!1)}};return(0,o.jsx)(s.Z,{children:(0,o.jsxs)("div",{className:"space-y-6",children:[(0,o.jsxs)("div",{className:"flex items-center gap-4",children:[(0,o.jsx)(c.default,{href:"/admin/cobradores",className:"p-2 hover:bg-gray-100 rounded-lg",children:(0,o.jsx)(i.Z,{className:"w-5 h-5"})}),(0,o.jsxs)("div",{children:[(0,o.jsx)("h1",{className:"text-2xl font-semibold text-gray-900",children:"Nuevo Cobrador"}),(0,o.jsx)("p",{className:"text-gray-600",children:"Registra un nuevo cobrador externo"})]})]}),d&&(0,o.jsx)("div",{className:"p-4 rounded-lg ".concat(d.includes("Error")?"bg-red-50 text-red-800 border border-red-200":"bg-green-50 text-green-800 border border-green-200"),children:d}),(0,o.jsx)("div",{className:"bg-white rounded-lg shadow",children:(0,o.jsxs)("form",{onSubmit:v,className:"p-6 space-y-6",children:[(0,o.jsxs)("div",{children:[(0,o.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Informaci\xf3n Personal"}),(0,o.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nombres *"}),(0,o.jsx)("input",{type:"text",required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500",value:b.nombres,onChange:e=>f(r=>({...r,nombres:e.target.value})),placeholder:"Mar\xeda",disabled:"CLUB"===b.tipoCobrador}),"CLUB"===b.tipoCobrador&&(0,o.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"\uD83D\uDCCC Nombre predeterminado para cobrador institucional"})]}),"CLUB"!==b.tipoCobrador&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Apellidos *"}),(0,o.jsx)("input",{type:"text",required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500",value:b.apellidos,onChange:e=>f(r=>({...r,apellidos:e.target.value})),placeholder:"Gonz\xe1lez"})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"C\xe9dula de Identidad *"}),(0,o.jsx)("input",{type:"text",required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500",value:b.ci,onChange:e=>f(r=>({...r,ci:e.target.value})),placeholder:"3456789"})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),(0,o.jsx)("input",{type:"email",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500",value:b.email,onChange:e=>f(r=>({...r,email:e.target.value})),placeholder:"maria.gonzalez@email.com"})]})]})]})]}),"CLUB"!==b.tipoCobrador&&(0,o.jsxs)("div",{children:[(0,o.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Informaci\xf3n de Contacto"}),(0,o.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tel\xe9fono"}),(0,o.jsx)("input",{type:"tel",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500",value:b.telefono,onChange:e=>f(r=>({...r,telefono:e.target.value})),placeholder:"0981-123456"})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Celular"}),(0,o.jsx)("input",{type:"tel",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500",value:b.celular,onChange:e=>f(r=>({...r,celular:e.target.value})),placeholder:"0981-123456"})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Direcci\xf3n"}),(0,o.jsx)("input",{type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500",value:b.direccion,onChange:e=>f(r=>({...r,direccion:e.target.value})),placeholder:"Asunci\xf3n"})]})]})]}),(0,o.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,o.jsxs)("div",{children:[(0,o.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Tipo de Cobrador y Comisiones"}),(0,o.jsx)("div",{className:"space-y-4",children:(0,o.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tipo de Cobrador *"}),(0,o.jsxs)("select",{required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500",value:b.tipoCobrador,onChange:e=>j(e.target.value),disabled:g,children:[(0,o.jsx)("option",{value:"EXTERNO",children:"Externo"}),(0,o.jsx)("option",{value:"PROFESOR",children:"Profesor"}),!y&&(0,o.jsx)("option",{value:"CLUB",children:"Garden Club"})]})]}),("EXTERNO"===b.tipoCobrador||"PROFESOR"===b.tipoCobrador)&&(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Comisi\xf3n % *"}),(0,o.jsx)("input",{type:"number",required:"EXTERNO"===b.tipoCobrador||"PROFESOR"===b.tipoCobrador,min:"0",max:"100",step:"0.1",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500",value:b.comisionPorDefecto,onChange:e=>f(r=>({...r,comisionPorDefecto:e.target.value})),placeholder:"12.5"})]})]})})]}),"CLUB"!==b.tipoCobrador&&(0,o.jsxs)("div",{children:[(0,o.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Informaci\xf3n de Pago"}),(0,o.jsxs)("div",{className:"space-y-4",children:[(0,o.jsxs)("div",{children:[(0,o.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Formas de Pago Aceptadas * ",(0,o.jsx)("span",{className:"text-xs text-gray-500",children:"(Seleccione al menos una)"})]}),(0,o.jsxs)("div",{className:"flex flex-wrap gap-4",children:[(0,o.jsxs)("label",{className:"flex items-center space-x-2 cursor-pointer",children:[(0,o.jsx)("input",{type:"checkbox",checked:b.formasPago.includes("efectivo"),onChange:()=>N("efectivo"),className:"w-4 h-4 text-primary-600 border-gray-300 rounded focus:ring-primary-500"}),(0,o.jsx)("span",{className:"text-sm text-gray-700",children:"Efectivo"})]}),(0,o.jsxs)("label",{className:"flex items-center space-x-2 cursor-pointer",children:[(0,o.jsx)("input",{type:"checkbox",checked:b.formasPago.includes("transferencia"),onChange:()=>N("transferencia"),className:"w-4 h-4 text-primary-600 border-gray-300 rounded focus:ring-primary-500"}),(0,o.jsx)("span",{className:"text-sm text-gray-700",children:"Transferencia"})]}),(0,o.jsxs)("label",{className:"flex items-center space-x-2 cursor-pointer",children:[(0,o.jsx)("input",{type:"checkbox",checked:b.formasPago.includes("cheque"),onChange:()=>N("cheque"),className:"w-4 h-4 text-primary-600 border-gray-300 rounded focus:ring-primary-500"}),(0,o.jsx)("span",{className:"text-sm text-gray-700",children:"Cheque"})]})]}),0===b.formasPago.length&&(0,o.jsx)("p",{className:"text-xs text-red-600 mt-1",children:"Debe seleccionar al menos una forma de pago"})]}),b.formasPago.includes("transferencia")&&(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Cuenta Bancaria"}),(0,o.jsx)("input",{type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500",value:b.cuentaBanco,onChange:e=>f(r=>({...r,cuentaBanco:e.target.value})),placeholder:"1234567890"})]})]})]}),"CLUB"===b.tipoCobrador&&(0,o.jsx)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:(0,o.jsxs)("p",{className:"text-sm text-blue-800",children:["\uD83D\uDCB3 ",(0,o.jsx)("strong",{children:"Garden Club"})," acepta autom\xe1ticamente todos los m\xe9todos de pago: Efectivo, Transferencia y Cheque."]})})]}),(0,o.jsxs)("div",{className:"flex justify-end gap-3 pt-6 border-t",children:[(0,o.jsx)(c.default,{href:"/admin/cobradores",className:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50",children:"Cancelar"}),(0,o.jsx)("button",{type:"submit",disabled:r,className:"px-4 py-2 bg-primary-500 text-white rounded-lg hover:bg-primary-600 disabled:opacity-50",children:r?"Creando...":"Crear Cobrador"})]})]})})]})})}},32660:function(e,r,a){"use strict";a.d(r,{Z:function(){return o}});let o=(0,a(39763).Z)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])}},function(e){e.O(0,[3643,9690,2971,2117,1744],function(){return e(e.s=84902)}),_N_E=e.O()}]);