(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5591],{16602:function(e,t,s){Promise.resolve().then(s.bind(s,85301))},85301:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return p}});var a=s(57437),n=s(69690),r=s(17985),i=s(2265),o=s(94508),d=s(95805),c=s(95252),l=s(22252),x=s(70525),m=s(42208),u=s(27648);function p(){let[e,t]=(0,i.useState)([]),[s,p]=(0,i.useState)(!0),[g,h]=(0,i.useState)(""),[f,y]=(0,i.useState)("");async function j(){try{let e=await r.L.authenticatedFetch("/api/collectors"),s=await e.json();if(!Array.isArray(s)){t([]);return}let a=s.map(async e=>{try{var t;let s=await r.L.authenticatedFetch("/api/collectors/".concat(e.id,"/commissions")),a=await s.json();return{id:e.id,codigo:e.codigo,nombres:e.nombres,apellidos:e.apellidos,tipoCobrador:e.tipoCobrador||"EXTERNO",activo:e.activo,totales:a.totales||{generados:0,pendientes:0,pagados:0},cantidadPagosPendientes:(null===(t=a.pagosPendientes)||void 0===t?void 0:t.length)||0}}catch(t){return console.error("Error loading commissions for ".concat(e.codigo,":"),t),{id:e.id,codigo:e.codigo,nombres:e.nombres,apellidos:e.apellidos,tipoCobrador:e.tipoCobrador||"EXTERNO",activo:e.activo,totales:{generados:0,pendientes:0,pagados:0},cantidadPagosPendientes:0}}}),n=await Promise.all(a);t(n)}catch(e){console.error("Error loading comisiones:",e),t([])}finally{p(!1)}}(0,i.useEffect)(()=>{j()},[]);let b=e.filter(e=>{if("CLUB"===e.tipoCobrador)return!1;let t=!g||e.tipoCobrador===g,s=!f||"activo"===f&&e.activo||"inactivo"===f&&!e.activo||"pendientes"===f&&e.totales.pendientes>0;return t&&s}),v=b.reduce((e,t)=>({generados:e.generados+t.totales.generados,pendientes:e.pendientes+t.totales.pendientes,pagados:e.pagados+t.totales.pagados}),{generados:0,pendientes:0,pagados:0}),N=e=>(0,a.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium ".concat({CLUB:"bg-gray-100 text-gray-800",EXTERNO:"bg-purple-100 text-purple-800",PROFESOR:"bg-blue-100 text-blue-800"}[e]),children:{CLUB:"Garden Club",EXTERNO:"Externo",PROFESOR:"Profesor"}[e]});return s?(0,a.jsx)(n.Z,{children:(0,a.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-500"})})}):(0,a.jsx)(n.Z,{children:(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-2xl font-semibold text-gray-900",children:"Dashboard de Comisiones"}),(0,a.jsx)("p",{className:"text-gray-600",children:"Vista general de todas las comisiones de cobradores"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,a.jsx)("div",{className:"bg-white p-6 rounded-lg shadow",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-sm text-gray-600 mb-1",children:"Cobradores con Comisiones"}),(0,a.jsx)("div",{className:"text-2xl font-bold text-gray-900",children:b.length})]}),(0,a.jsx)(d.Z,{className:"w-8 h-8 text-gray-400"})]})}),(0,a.jsx)("div",{className:"bg-white p-6 rounded-lg shadow",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-sm text-gray-600 mb-1",children:"Total Generado"}),(0,a.jsx)("div",{className:"text-2xl font-bold text-green-600",children:(0,o.xG)(v.generados)})]}),(0,a.jsx)(c.Z,{className:"w-8 h-8 text-green-400"})]})}),(0,a.jsx)("div",{className:"bg-white p-6 rounded-lg shadow",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-sm text-gray-600 mb-1",children:"Pendiente de Pago"}),(0,a.jsx)("div",{className:"text-2xl font-bold text-orange-600",children:(0,o.xG)(v.pendientes)})]}),(0,a.jsx)(l.Z,{className:"w-8 h-8 text-orange-400"})]})}),(0,a.jsx)("div",{className:"bg-white p-6 rounded-lg shadow",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-sm text-gray-600 mb-1",children:"Total Pagado"}),(0,a.jsx)("div",{className:"text-2xl font-bold text-blue-600",children:(0,o.xG)(v.pagados)})]}),(0,a.jsx)(x.Z,{className:"w-8 h-8 text-blue-400"})]})})]}),(0,a.jsx)("div",{className:"bg-white p-6 rounded-lg shadow",children:(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tipo de Cobrador"}),(0,a.jsxs)("select",{className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500",value:g,onChange:e=>h(e.target.value),children:[(0,a.jsx)("option",{value:"",children:"Todos (Externo + Profesor)"}),(0,a.jsx)("option",{value:"EXTERNO",children:"Solo Externos"}),(0,a.jsx)("option",{value:"PROFESOR",children:"Solo Profesores"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Estado"}),(0,a.jsxs)("select",{className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500",value:f,onChange:e=>y(e.target.value),children:[(0,a.jsx)("option",{value:"",children:"Todos los estados"}),(0,a.jsx)("option",{value:"activo",children:"Solo Activos"}),(0,a.jsx)("option",{value:"pendientes",children:"Con Pendientes"}),(0,a.jsx)("option",{value:"inactivo",children:"Inactivos"})]})]}),(0,a.jsx)("div",{className:"flex items-end",children:(0,a.jsx)("button",{onClick:()=>{h(""),y("")},className:"w-full px-3 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Limpiar Filtros"})})]})}),(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"w-full",children:[(0,a.jsx)("thead",{className:"bg-gray-50",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Cobrador"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Tipo"}),(0,a.jsx)("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Estado"}),(0,a.jsx)("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Total Generado"}),(0,a.jsx)("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Pendiente"}),(0,a.jsx)("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Pagado"}),(0,a.jsx)("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Pagos Pendientes"}),(0,a.jsx)("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Acciones"})]})}),(0,a.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:b.map(e=>(0,a.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"text-sm font-medium text-gray-900",children:[e.nombres," ",e.apellidos]}),(0,a.jsx)("div",{className:"text-sm text-gray-500",children:e.codigo})]})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:N(e.tipoCobrador)}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-center",children:(0,a.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ".concat(e.activo?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"),children:e.activo?"Activo":"Inactivo"})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-right",children:(0,a.jsx)("div",{className:"text-sm font-medium text-green-600",children:(0,o.xG)(e.totales.generados)})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-right",children:(0,a.jsx)("div",{className:"text-sm font-medium ".concat(e.totales.pendientes>0?"text-orange-600":"text-gray-400"),children:(0,o.xG)(e.totales.pendientes)})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-right",children:(0,a.jsx)("div",{className:"text-sm font-medium text-blue-600",children:(0,o.xG)(e.totales.pagados)})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-center",children:e.cantidadPagosPendientes>0?(0,a.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-orange-100 text-orange-800",children:e.cantidadPagosPendientes}):(0,a.jsx)("span",{className:"text-gray-400",children:"-"})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-right",children:(0,a.jsxs)(u.default,{href:"/admin/cobradores/".concat(e.id),className:"text-primary-600 hover:text-primary-900 inline-flex items-center gap-1",children:[(0,a.jsx)(m.Z,{className:"w-4 h-4"}),(0,a.jsx)("span",{className:"text-sm",children:"Ver detalle"})]})})]},e.id))})]})}),0===b.length&&(0,a.jsxs)("div",{className:"text-center py-12",children:[(0,a.jsx)(l.Z,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),(0,a.jsx)("div",{className:"text-gray-500",children:g||f?"No se encontraron cobradores con los filtros aplicados":"No hay cobradores con comisiones registrados"})]})]}),(0,a.jsx)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:(0,a.jsxs)("div",{className:"flex items-start gap-2",children:[(0,a.jsx)(l.Z,{className:"w-5 h-5 text-blue-600 mt-0.5 flex-shrink-0"}),(0,a.jsxs)("div",{className:"text-sm text-blue-800",children:[(0,a.jsx)("strong",{children:"Nota:"}),' Los cobradores tipo "Club" no aparecen en esta lista ya que no generan comisiones. Solo se muestran los cobradores tipo "Externo" y "Profesor" que s\xed reciben comisiones por los pagos cobrados.']})]})})]})})}},45365:function(e,t,s){"use strict";s.d(t,{D2:function(){return a},LJ:function(){return r},_4:function(){return i},tF:function(){return n}});let a={name:"America/Asuncion",offsetHours:-3,description:"Paraguay (UTC-3)"};function n(){let e=new Date,t=Object.fromEntries(new Intl.DateTimeFormat("en-CA",{timeZone:a.name,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}).formatToParts(e).map(e=>[e.type,e.value]));return new Date(parseInt(t.year),parseInt(t.month)-1,parseInt(t.day),parseInt(t.hour),parseInt(t.minute),parseInt(t.second))}function r(e){if(e){let t=e.getFullYear(),s=String(e.getMonth()+1).padStart(2,"0"),a=String(e.getDate()).padStart(2,"0");return"".concat(t,"-").concat(s,"-").concat(a)}{let e=new Date;return new Intl.DateTimeFormat("en-CA",{timeZone:a.name,year:"numeric",month:"2-digit",day:"2-digit"}).format(e)}}function i(e){let t,s=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if("string"==typeof e){if(/^\d{4}-\d{2}-\d{2}$/.test(e)){let[s,a,n]=e.split("-").map(Number);t=new Date(s,a-1,n)}else t=new Date(e)}else t=e;if(s)return t.toLocaleString("es-PY",{timeZone:a.name,day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit",hour12:!1});if(!("string"==typeof e&&/^\d{4}-\d{2}-\d{2}$/.test(e)))return t.toLocaleDateString("es-PY",{timeZone:a.name,day:"2-digit",month:"2-digit",year:"numeric"});{let[t,s,a]=e.split("-");return"".concat(a.padStart(2,"0"),"/").concat(s.padStart(2,"0"),"/").concat(t)}}},94508:function(e,t,s){"use strict";s.d(t,{Fw:function(){return i},Ji:function(){return o},m9:function(){return d},p6:function(){return r},sQ:function(){return l},sU:function(){return c},xG:function(){return n}});var a=s(45365);function n(e){return new Intl.NumberFormat("es-PY",{style:"currency",currency:"PYG",minimumFractionDigits:0}).format(e)}function r(e){return(0,a._4)(e,!1)}function i(e){let t=(0,a.tF)(),s=new Date(new Date(e).getTime()+108e5),n=t.getUTCFullYear()-s.getUTCFullYear(),r=t.getUTCMonth()-s.getUTCMonth();return(r<0||0===r&&t.getUTCDate()<s.getUTCDate())&&n--,n}function o(){return(0,a.LJ)()}function d(e){let t=e.replace(/\D/g,"");return t?t.replace(/\B(?=(\d{3})+(?!\d))/g,"."):""}function c(e){return parseInt(e.replace(/\./g,""))||0}function l(e){return Math.round(e)}},95252:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(39763).Z)("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]])},42208:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(39763).Z)("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},70525:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(39763).Z)("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]])},95805:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(39763).Z)("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]])}},function(e){e.O(0,[3643,9690,2971,2117,1744],function(){return e(e.s=16602)}),_N_E=e.O()}]);