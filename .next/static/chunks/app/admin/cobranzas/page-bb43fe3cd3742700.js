(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5113],{97364:function(e,t,r){Promise.resolve().then(r.bind(r,72834))},72834:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return g}});var a=r(57437),s=r(69690),n=r(17985),i=r(2265),l=r(94508),c=r(70525),o=r(92735),d=r(99397),x=r(90740),m=r(73247),u=r(95252),h=r(27648);function g(){let[e,t]=(0,i.useState)([]),[r,g]=(0,i.useState)(!0),[p,f]=(0,i.useState)(""),[y,j]=(0,i.useState)(""),[v,b]=(0,i.useState)(""),[N,w]=(0,i.useState)(""),[C,k]=(0,i.useState)(!1),[Z,F]=(0,i.useState)(""),[S,D]=(0,i.useState)("");async function T(){try{let e=await n.L.authenticatedFetch("/api/payments"),r=await e.json();t(Array.isArray(r)?r:[])}catch(e){console.error("Error loading payments:",e),t([])}finally{g(!1)}}(0,i.useEffect)(()=>{T()},[]);let P=e.filter(e=>{var t,r,a;let s=e.concepto.toLowerCase().includes(p.toLowerCase())||(null===(t=e.memberName)||void 0===t?void 0:t.toLowerCase().includes(p.toLowerCase()))||(null===(r=e.memberCode)||void 0===r?void 0:r.toLowerCase().includes(p.toLowerCase()))||(null===(a=e.numeroRecibo)||void 0===a?void 0:a.toLowerCase().includes(p.toLowerCase())),n=!y||e.formaPago===y,i=!v||e.fecha.startsWith(v),l=!N||e.cobradorId===N,c=!Z||e.fecha>=Z,o=!S||e.fecha<=S;return s&&n&&i&&l&&c&&o}),L=async e=>{try{let t=await n.L.authenticatedFetch("/api/payments/export?format=".concat(e)),r=await t.blob(),a=window.URL.createObjectURL(r),s=document.createElement("a");s.href=a,s.download="cobranzas-".concat(new Date().toISOString().split("T")[0],".").concat("excel"===e?"csv":"pdf"),document.body.appendChild(s),s.click(),window.URL.revokeObjectURL(a),document.body.removeChild(s)}catch(e){console.error("Error exporting payments:",e)}},I=e=>(0,a.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium ".concat({efectivo:"bg-green-100 text-green-800",transferencia:"bg-blue-100 text-blue-800",tarjeta:"bg-purple-100 text-purple-800",cheque:"bg-orange-100 text-orange-800"}[e]||"bg-gray-100 text-gray-800"),children:{efectivo:"Efectivo",transferencia:"Transferencia",tarjeta:"Tarjeta",cheque:"Cheque"}[e]||e}),E=P.reduce((e,t)=>e+t.monto,0),U=P.reduce((e,t)=>e+(t.comisionCobrador||0),0);return r?(0,a.jsx)(s.Z,{children:(0,a.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-500"})})}):(0,a.jsx)(s.Z,{children:(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-2xl font-semibold text-gray-900",children:"Gesti\xf3n de Cobranzas"}),(0,a.jsx)("p",{className:"text-gray-600",children:"Administra los pagos y cobranzas del club"})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsxs)(h.default,{href:"/admin/reportes",className:"bg-purple-500 text-white px-4 py-2 rounded-lg hover:bg-purple-600 flex items-center gap-2",children:[(0,a.jsx)(c.Z,{className:"w-4 h-4"}),"Reportes"]}),(0,a.jsxs)("button",{onClick:()=>L("excel"),className:"bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 flex items-center gap-2",children:[(0,a.jsx)(o.Z,{className:"w-4 h-4"}),"Excel"]}),(0,a.jsxs)(h.default,{href:"/admin/cobranzas/nuevo",className:"bg-primary-500 text-white px-4 py-2 rounded-lg hover:bg-primary-600 flex items-center gap-2",children:[(0,a.jsx)(d.Z,{className:"w-4 h-4"}),"Nuevo Pago"]})]})]}),(0,a.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,a.jsx)("h3",{className:"text-lg font-medium",children:"Filtros de B\xfasqueda"}),(0,a.jsxs)("button",{onClick:()=>k(!C),className:"flex items-center gap-2 text-primary-600 hover:text-primary-800",children:[(0,a.jsx)(x.Z,{className:"w-4 h-4"}),C?"Ocultar Filtros":"Filtros Avanzados"]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Buscar"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(m.Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),(0,a.jsx)("input",{type:"text",placeholder:"Concepto, socio, recibo...",className:"w-full pl-10 pr-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500",value:p,onChange:e=>f(e.target.value)})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Forma de Pago"}),(0,a.jsxs)("select",{className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500",value:y,onChange:e=>j(e.target.value),children:[(0,a.jsx)("option",{value:"",children:"Todas"}),(0,a.jsx)("option",{value:"efectivo",children:"Efectivo"}),(0,a.jsx)("option",{value:"transferencia",children:"Transferencia"}),(0,a.jsx)("option",{value:"tarjeta",children:"Tarjeta"}),(0,a.jsx)("option",{value:"cheque",children:"Cheque"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Cobrador"}),(0,a.jsxs)("select",{className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500",value:N,onChange:e=>w(e.target.value),children:[(0,a.jsx)("option",{value:"",children:"Todos"}),(0,a.jsx)("option",{value:"interno",children:"Caja Interna"})]})]}),(0,a.jsx)("div",{className:"flex items-end",children:(0,a.jsx)("button",{onClick:()=>{f(""),j(""),b(""),w(""),F(""),D("")},className:"w-full px-3 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Limpiar Filtros"})})]}),C&&(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 pt-4 border-t",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Fecha Desde"}),(0,a.jsx)("input",{type:"date",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500",value:Z,onChange:e=>F(e.target.value)})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Fecha Hasta"}),(0,a.jsx)("input",{type:"date",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500",value:S,onChange:e=>D(e.target.value)})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Mes/A\xf1o"}),(0,a.jsx)("input",{type:"month",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500",value:v,onChange:e=>b(e.target.value)})]})]})]}),(0,a.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"An\xe1lisis de Cobranzas"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,a.jsx)("div",{children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-blue-600",children:P.filter(e=>"efectivo"===e.formaPago).length}),(0,a.jsx)("div",{className:"text-sm text-gray-600",children:"Pagos en Efectivo"})]})}),(0,a.jsx)("div",{children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-green-600",children:P.filter(e=>"transferencia"===e.formaPago).length}),(0,a.jsx)("div",{className:"text-sm text-gray-600",children:"Transferencias"})]})}),(0,a.jsx)("div",{children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-purple-600",children:P.filter(e=>e.cobradorId).length}),(0,a.jsx)("div",{className:"text-sm text-gray-600",children:"Por Cobradores"})]})}),(0,a.jsx)("div",{children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsxs)("div",{className:"text-2xl font-bold text-orange-600",children:[(U/E*100).toFixed(1),"%"]}),(0,a.jsx)("div",{className:"text-sm text-gray-600",children:"% Comisiones"})]})})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,a.jsx)("div",{className:"bg-white p-4 rounded-lg shadow",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(u.Z,{className:"w-8 h-8 text-green-600 mr-3"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-gray-900",children:(0,l.xG)(E)}),(0,a.jsx)("div",{className:"text-sm text-gray-600",children:"Total Cobrado"})]})]})}),(0,a.jsxs)("div",{className:"bg-white p-4 rounded-lg shadow",children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-gray-900",children:P.length}),(0,a.jsx)("div",{className:"text-sm text-gray-600",children:"Total Pagos"})]}),(0,a.jsxs)("div",{className:"bg-white p-4 rounded-lg shadow",children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-orange-600",children:(0,l.xG)(U)}),(0,a.jsx)("div",{className:"text-sm text-gray-600",children:"Comisiones"})]}),(0,a.jsxs)("div",{className:"bg-white p-4 rounded-lg shadow",children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-blue-600",children:P.filter(e=>"efectivo"===e.formaPago).length}),(0,a.jsx)("div",{className:"text-sm text-gray-600",children:"Pagos Efectivo"})]})]}),(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"w-full",children:[(0,a.jsx)("thead",{className:"bg-gray-50",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Fecha"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Socio"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Concepto"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Monto"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Forma Pago"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Cobrador"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Recibo"})]})}),(0,a.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:P.map(e=>(0,a.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:new Date(e.fecha).toLocaleDateString("es-PY")}),(0,a.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap",children:[(0,a.jsx)("div",{className:"text-sm font-medium text-gray-900",children:e.memberName||"N/A"}),(0,a.jsx)("div",{className:"text-sm text-gray-500",children:e.memberCode||"N/A"})]}),(0,a.jsxs)("td",{className:"px-6 py-4",children:[(0,a.jsx)("div",{className:"text-sm text-gray-900",children:e.concepto}),e.observaciones&&(0,a.jsx)("div",{className:"text-sm text-gray-500",children:e.observaciones})]}),(0,a.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap",children:[(0,a.jsx)("div",{className:"text-sm font-medium text-gray-900",children:(0,l.xG)(e.monto)}),e.comisionCobrador&&(0,a.jsxs)("div",{className:"text-xs text-orange-600",children:["Comisi\xf3n: ",(0,l.xG)(e.comisionCobrador)]})]}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:I(e.formaPago)}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.cobradorName||"Caja Interna"}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.numeroRecibo||"-"})]},e.id))})]})}),0===P.length&&(0,a.jsxs)("div",{className:"text-center py-12",children:[(0,a.jsx)("div",{className:"text-gray-500",children:p||y||v||N?"No se encontraron pagos con los filtros aplicados":"No hay pagos registrados"}),!p&&!y&&!v&&!N&&(0,a.jsxs)(h.default,{href:"/admin/cobranzas/nuevo",className:"mt-4 inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-primary-600 bg-primary-100 hover:bg-primary-200",children:[(0,a.jsx)(d.Z,{className:"w-4 h-4 mr-2"}),"Registrar primer pago"]})]})]})]})})}},45365:function(e,t,r){"use strict";r.d(t,{D2:function(){return a},LJ:function(){return n},_4:function(){return i},tF:function(){return s}});let a={name:"America/Asuncion",offsetHours:-3,description:"Paraguay (UTC-3)"};function s(){let e=new Date,t=Object.fromEntries(new Intl.DateTimeFormat("en-CA",{timeZone:a.name,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}).formatToParts(e).map(e=>[e.type,e.value]));return new Date(parseInt(t.year),parseInt(t.month)-1,parseInt(t.day),parseInt(t.hour),parseInt(t.minute),parseInt(t.second))}function n(e){if(e){let t=e.getFullYear(),r=String(e.getMonth()+1).padStart(2,"0"),a=String(e.getDate()).padStart(2,"0");return"".concat(t,"-").concat(r,"-").concat(a)}{let e=new Date;return new Intl.DateTimeFormat("en-CA",{timeZone:a.name,year:"numeric",month:"2-digit",day:"2-digit"}).format(e)}}function i(e){let t,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if("string"==typeof e){if(/^\d{4}-\d{2}-\d{2}$/.test(e)){let[r,a,s]=e.split("-").map(Number);t=new Date(r,a-1,s)}else t=new Date(e)}else t=e;if(r)return t.toLocaleString("es-PY",{timeZone:a.name,day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit",hour12:!1});if(!("string"==typeof e&&/^\d{4}-\d{2}-\d{2}$/.test(e)))return t.toLocaleDateString("es-PY",{timeZone:a.name,day:"2-digit",month:"2-digit",year:"numeric"});{let[t,r,a]=e.split("-");return"".concat(a.padStart(2,"0"),"/").concat(r.padStart(2,"0"),"/").concat(t)}}},94508:function(e,t,r){"use strict";r.d(t,{Fw:function(){return i},Ji:function(){return l},m9:function(){return c},p6:function(){return n},sQ:function(){return d},sU:function(){return o},xG:function(){return s}});var a=r(45365);function s(e){return new Intl.NumberFormat("es-PY",{style:"currency",currency:"PYG",minimumFractionDigits:0}).format(e)}function n(e){return(0,a._4)(e,!1)}function i(e){let t=(0,a.tF)(),r=new Date(new Date(e).getTime()+108e5),s=t.getUTCFullYear()-r.getUTCFullYear(),n=t.getUTCMonth()-r.getUTCMonth();return(n<0||0===n&&t.getUTCDate()<r.getUTCDate())&&s--,s}function l(){return(0,a.LJ)()}function c(e){let t=e.replace(/\D/g,"");return t?t.replace(/\B(?=(\d{3})+(?!\d))/g,"."):""}function o(e){return parseInt(e.replace(/\./g,""))||0}function d(e){return Math.round(e)}},95252:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});let a=(0,r(39763).Z)("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]])},92735:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});let a=(0,r(39763).Z)("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]])},90740:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});let a=(0,r(39763).Z)("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]])},99397:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});let a=(0,r(39763).Z)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},73247:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});let a=(0,r(39763).Z)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]])},70525:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});let a=(0,r(39763).Z)("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]])}},function(e){e.O(0,[3643,9690,2971,2117,1744],function(){return e(e.s=97364)}),_N_E=e.O()}]);