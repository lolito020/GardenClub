"use strict";(()=>{var e={};e.id=7716,e.ids=[7716],e.modules={72934:e=>{e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},78893:e=>{e.exports=require("buffer")},84770:e=>{e.exports=require("crypto")},92048:e=>{e.exports=require("fs")},55315:e=>{e.exports=require("path")},76162:e=>{e.exports=require("stream")},21764:e=>{e.exports=require("util")},87561:e=>{e.exports=require("node:fs")},93977:e=>{e.exports=require("node:fs/promises")},49411:e=>{e.exports=require("node:path")},41041:e=>{e.exports=require("node:url")},67782:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>y,patchFetch:()=>b,requestAsyncStorage:()=>p,routeModule:()=>f,serverHooks:()=>g,staticGenerationAsyncStorage:()=>m});var n={};r.r(n),r.d(n,{POST:()=>d,dynamic:()=>l});var a=r(49303),o=r(88716),s=r(60670),i=r(87070),u=r(90455),c=r(71615);let l="force-dynamic";async function d(){return(0,c.cookies)().set(u.B$,"",{path:"/",maxAge:0}),i.NextResponse.json({ok:!0})}let f=new a.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/auth/logout/route",pathname:"/api/auth/logout",filename:"route",bundlePath:"app/api/auth/logout/route"},resolvedPagePath:"C:\\Garden\\app\\api\\auth\\logout\\route.ts",nextConfigOutput:"standalone",userland:n}),{requestAsyncStorage:p,staticGenerationAsyncStorage:m,serverHooks:g}=f,y="/api/auth/logout/route";function b(){return(0,s.patchFetch)({serverHooks:g,staticGenerationAsyncStorage:m})}},90455:(e,t,r)=>{r.d(t,{B$:()=>c,hm:()=>l,mk:()=>f,zB:()=>d});var n=r(41482),a=r.n(n),o=r(42023),s=r.n(o),i=r(9487);let u=process.env.JWT_SECRET||"dev-secret",c="gcp_token";async function l(){return 0===(await (0,i.getDb)()).data.users.length}async function d(e,t){let r=await (0,i.getDb)();if(0===r.data.users.length)return{token:a().sign({sub:"setup-admin",rol:"admin",nombre:"Administrador (setup)",email:"setup@local"},u,{expiresIn:"8h"}),user:{email:"setup@local",rol:"admin",nombre:"Administrador (setup)"}};let n=r.data.users.find(t=>t.email===e);return n&&await s().compare(t,n.passwordHash)?{token:a().sign({sub:n.id,rol:n.rol,nombre:n.nombre,email:n.email},u,{expiresIn:"8h"}),user:{email:n.email,rol:n.rol,nombre:n.nombre}}:null}async function f(e,t){if(0===(await (0,i.getDb)()).data.users.length)return{sub:"setup-admin",rol:"admin",nombre:"Administrador (setup)",email:"setup@local"};if(!e)return null;let r=e.cookies.get(c)?.value;if(!r)return null;try{let e=a().verify(r,u);if(t&&!t.includes(e.rol))return null;return e}catch{return null}}},9487:(e,t,r)=>{let n;r.r(t),r.d(t,{addDays:()=>P,calculateMemberDebt:()=>k,calculatePaidAmountForDebit:()=>D,computeQuote:()=>v,convertNoSocioToSocio:()=>d,endOfMonth:()=>j,formatCurrency:()=>R,getDb:()=>c,getMemberStatus:()=>C,hasReservationConflict:()=>q,nextCollectorCode:()=>f,nextCommissionId:()=>y,nextFamilyId:()=>m,nextFinancingId:()=>g,nextMemberCode:()=>l,nextMovementId:()=>A,nextPaymentId:()=>p,nextRefinancingId:()=>x,nextReservationId:()=>w,nextReservationPaymentId:()=>h,nextResourceId:()=>b,nextSubscriptionId:()=>S,startOfMonth:()=>O,toISODate:()=>M,yyyymm:()=>I});var a=r(26411),o=r(92048),s=r.n(o),i=r(55315),u=r.n(i);function c(){if(!n){let e=function(){let e=u().join(process.cwd(),"data");return s().existsSync(e)||s().mkdirSync(e,{recursive:!0}),u().join(e,"db.json")}();n=(0,a.cW)(e,{members:[],payments:[],services:[],users:[],collectors:[],families:[],financing:[],commissionPayments:[],movements:[],attachments:[],resources:[],reservations:[],reservationPayments:[],categories:[],memberSubscriptions:[],refinancings:[],sequences:{member:0,payment:0,collector:0,family:0,financing:0,commission:0,resource:0,reservation:0,reservationPayment:0,subscription:0,movement:0,refinancing:0}})}return n}async function l(){let e=await c();return e.data.sequences.member+=1,await e.write(),String(e.data.sequences.member)}async function d(e){let t=await c(),r=t.data.members.findIndex(t=>t.id===e);if(-1===r)throw Error("Member not found");let n=t.data.members[r];if("NO SOCIO"!==n.subcategoria)throw Error("Member is not a no-socio");let a=await l();return t.data.members[r]={...n,codigo:a,categoria:"Individual",subcategoria:"Socio"},await t.write(),t.data.members[r]}async function f(){let e=await c();return e.data.sequences.collector+=1,await e.write(),`COB-${String(e.data.sequences.collector).padStart(3,"0")}`}async function p(){let e=await c();return e.data.sequences.payment+=1,await e.write(),`PAY-${String(e.data.sequences.payment).padStart(6,"0")}`}async function m(){let e=await c();return e.data.sequences.family+=1,await e.write(),`FAM-${String(e.data.sequences.family).padStart(4,"0")}`}async function g(){let e=await c();return e.data.sequences.financing+=1,await e.write(),`FIN-${String(e.data.sequences.financing).padStart(4,"0")}`}async function y(){let e=await c();return e.data.sequences.commission+=1,await e.write(),`COM-${String(e.data.sequences.commission).padStart(6,"0")}`}async function b(){let e=await c();return e.data.sequences.resource+=1,await e.write(),`RESRC-${String(e.data.sequences.resource).padStart(4,"0")}`}async function w(){let e=await c();return e.data.sequences.reservation+=1,await e.write(),`RES-${String(e.data.sequences.reservation).padStart(6,"0")}`}async function h(){let e=await c();return e.data.sequences.reservationPayment+=1,await e.write(),`RESPAY-${String(e.data.sequences.reservationPayment).padStart(6,"0")}`}async function S(){let e=await c();return e.data.sequences.subscription+=1,await e.write(),`SUB-${String(e.data.sequences.subscription).padStart(6,"0")}`}async function A(){let e=await c();return e.data.sequences.movement+=1,await e.write(),`MOV-${String(e.data.sequences.movement).padStart(6,"0")}`}async function x(){let e=await c();return e.data.sequences.refinancing+=1,await e.write(),`REF-${String(e.data.sequences.refinancing).padStart(6,"0")}`}function v(e,t,r,n,a=0){let o=e.data.resources.find(e=>e.id===t),s=o?.precioBaseHora??0,i=new Date(r).getTime(),u=Math.max(1,Math.ceil((new Date(n).getTime()-i)/36e5)),c=s*u;return a>100&&(c=Math.round(1.05*c)),{horas:u,monto:c}}function q(e,t,r,n,a){let o=new Date(r).getTime(),s=new Date(n).getTime();return e.data.reservations.some(e=>e.resourceId===t&&e.id!==a&&Math.max(new Date(e.start).getTime(),o)<Math.min(new Date(e.end).getTime(),s)&&"CANCELADO"!==e.status)}function R(e){return new Intl.NumberFormat("es-PY",{style:"currency",currency:"PYG",minimumFractionDigits:0}).format(e)}function D(e,t){if(!e||"DEBIT"!==e.tipo)return 0;let r=0;for(let n of t)if(n.allocations&&Array.isArray(n.allocations))for(let t of n.allocations)t.debitId===e.id&&(r+=Number(t.amount||0));return r}function k(e,t){let n=0;for(let r of t)if(r.memberId===e.id&&"DEBIT"===r.tipo){if("REFINANCIADO"===r.status||"CANCELADO"===r.status)continue;let e=D(r,t),a=r.monto-e;a>0&&(n+=a)}let a=r(9487),o=0;try{for(let t of(a.getDb&&"function"==typeof a.getDb&&a.getDb().data?.refinancings||[]).filter(t=>t.memberId===e.id&&("ACTIVA"===t.status||"APROBADA"===t.status)))o+=Number(t.downPaymentAmount||0)}catch(e){}return Math.max(0,n-=o)}function C(e,t){return k(e,t)>0?"ATRASADO":"AL_DIA"}function M(e){let t="string"==typeof e?new Date(e):e,r=t.getFullYear(),n=String(t.getMonth()+1).padStart(2,"0"),a=String(t.getDate()).padStart(2,"0");return`${r}-${n}-${a}`}function P(e,t){let r=new Date("string"==typeof e?e:e.getTime());return r.setDate(r.getDate()+t),r}function O(e){let t="string"==typeof e?new Date(e):e;return new Date(t.getFullYear(),t.getMonth(),1)}function j(e){let t="string"==typeof e?new Date(e):e;return new Date(t.getFullYear(),t.getMonth()+1,0)}function I(e){let t="string"==typeof e?new Date(e):e;return`${t.getFullYear()}${String(t.getMonth()+1).padStart(2,"0")}`}},71615:(e,t,r)=>{var n=r(88757);r.o(n,"cookies")&&r.d(t,{cookies:function(){return n.cookies}})},33085:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"DraftMode",{enumerable:!0,get:function(){return o}});let n=r(45869),a=r(6278);class o{get isEnabled(){return this._provider.isEnabled}enable(){let e=n.staticGenerationAsyncStorage.getStore();return e&&(0,a.trackDynamicDataAccessed)(e,"draftMode().enable()"),this._provider.enable()}disable(){let e=n.staticGenerationAsyncStorage.getStore();return e&&(0,a.trackDynamicDataAccessed)(e,"draftMode().disable()"),this._provider.disable()}constructor(e){this._provider=e}}("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},88757:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{cookies:function(){return f},draftMode:function(){return p},headers:function(){return d}});let n=r(68996),a=r(53047),o=r(92044),s=r(72934),i=r(33085),u=r(6278),c=r(45869),l=r(54580);function d(){let e="headers",t=c.staticGenerationAsyncStorage.getStore();if(t){if(t.forceStatic)return a.HeadersAdapter.seal(new Headers({}));(0,u.trackDynamicDataAccessed)(t,e)}return(0,l.getExpectedRequestStore)(e).headers}function f(){let e="cookies",t=c.staticGenerationAsyncStorage.getStore();if(t){if(t.forceStatic)return n.RequestCookiesAdapter.seal(new o.RequestCookies(new Headers({})));(0,u.trackDynamicDataAccessed)(t,e)}let r=(0,l.getExpectedRequestStore)(e),a=s.actionAsyncStorage.getStore();return(null==a?void 0:a.isAction)||(null==a?void 0:a.isAppRoute)?r.mutableCookies:r.cookies}function p(){let e=(0,l.getExpectedRequestStore)("draftMode");return new i.DraftMode(e.draftMode)}("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},53047:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{HeadersAdapter:function(){return o},ReadonlyHeadersError:function(){return a}});let n=r(38238);class a extends Error{constructor(){super("Headers cannot be modified. Read more: https://nextjs.org/docs/app/api-reference/functions/headers")}static callable(){throw new a}}class o extends Headers{constructor(e){super(),this.headers=new Proxy(e,{get(t,r,a){if("symbol"==typeof r)return n.ReflectAdapter.get(t,r,a);let o=r.toLowerCase(),s=Object.keys(e).find(e=>e.toLowerCase()===o);if(void 0!==s)return n.ReflectAdapter.get(t,s,a)},set(t,r,a,o){if("symbol"==typeof r)return n.ReflectAdapter.set(t,r,a,o);let s=r.toLowerCase(),i=Object.keys(e).find(e=>e.toLowerCase()===s);return n.ReflectAdapter.set(t,i??r,a,o)},has(t,r){if("symbol"==typeof r)return n.ReflectAdapter.has(t,r);let a=r.toLowerCase(),o=Object.keys(e).find(e=>e.toLowerCase()===a);return void 0!==o&&n.ReflectAdapter.has(t,o)},deleteProperty(t,r){if("symbol"==typeof r)return n.ReflectAdapter.deleteProperty(t,r);let a=r.toLowerCase(),o=Object.keys(e).find(e=>e.toLowerCase()===a);return void 0===o||n.ReflectAdapter.deleteProperty(t,o)}})}static seal(e){return new Proxy(e,{get(e,t,r){switch(t){case"append":case"delete":case"set":return a.callable;default:return n.ReflectAdapter.get(e,t,r)}}})}merge(e){return Array.isArray(e)?e.join(", "):e}static from(e){return e instanceof Headers?e:new o(e)}append(e,t){let r=this.headers[e];"string"==typeof r?this.headers[e]=[r,t]:Array.isArray(r)?r.push(t):this.headers[e]=t}delete(e){delete this.headers[e]}get(e){let t=this.headers[e];return void 0!==t?this.merge(t):null}has(e){return void 0!==this.headers[e]}set(e,t){this.headers[e]=t}forEach(e,t){for(let[r,n]of this.entries())e.call(t,n,r,this)}*entries(){for(let e of Object.keys(this.headers)){let t=e.toLowerCase(),r=this.get(t);yield[t,r]}}*keys(){for(let e of Object.keys(this.headers)){let t=e.toLowerCase();yield t}}*values(){for(let e of Object.keys(this.headers)){let t=this.get(e);yield t}}[Symbol.iterator](){return this.entries()}}},68996:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{MutableRequestCookiesAdapter:function(){return d},ReadonlyRequestCookiesError:function(){return s},RequestCookiesAdapter:function(){return i},appendMutableCookies:function(){return l},getModifiedCookieValues:function(){return c}});let n=r(92044),a=r(38238),o=r(45869);class s extends Error{constructor(){super("Cookies can only be modified in a Server Action or Route Handler. Read more: https://nextjs.org/docs/app/api-reference/functions/cookies#cookiessetname-value-options")}static callable(){throw new s}}class i{static seal(e){return new Proxy(e,{get(e,t,r){switch(t){case"clear":case"delete":case"set":return s.callable;default:return a.ReflectAdapter.get(e,t,r)}}})}}let u=Symbol.for("next.mutated.cookies");function c(e){let t=e[u];return t&&Array.isArray(t)&&0!==t.length?t:[]}function l(e,t){let r=c(t);if(0===r.length)return!1;let a=new n.ResponseCookies(e),o=a.getAll();for(let e of r)a.set(e);for(let e of o)a.set(e);return!0}class d{static wrap(e,t){let r=new n.ResponseCookies(new Headers);for(let t of e.getAll())r.set(t);let s=[],i=new Set,c=()=>{let e=o.staticGenerationAsyncStorage.getStore();if(e&&(e.pathWasRevalidated=!0),s=r.getAll().filter(e=>i.has(e.name)),t){let e=[];for(let t of s){let r=new n.ResponseCookies(new Headers);r.set(t),e.push(r.toString())}t(e)}};return new Proxy(r,{get(e,t,r){switch(t){case u:return s;case"delete":return function(...t){i.add("string"==typeof t[0]?t[0]:t[0].name);try{e.delete(...t)}finally{c()}};case"set":return function(...t){i.add("string"==typeof t[0]?t[0]:t[0].name);try{return e.set(...t)}finally{c()}};default:return a.ReflectAdapter.get(e,t,r)}}})}}}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),n=t.X(0,[8948,5972,1482,4565],()=>r(67782));module.exports=n})();